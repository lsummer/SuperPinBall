var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,a){function r(t){try{h(n.next(t))}catch(e){a(e)}}function s(t){try{h(n["throw"](t))}catch(e){a(e)}}function h(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(r,s)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,a&&(r=a[2&i[0]?"return":i[0]?"throw":"next"])&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[0,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,a=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(r=h.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){h.label=i[1];break}if(6===i[0]&&h.label<r[1]){h.label=r[1],r=i;break}if(r&&h.label<r[2]){h.label=r[2],h.ops.push(i);break}r[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],a=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,a,r,s,h={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},TextField=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.TextField);__reflect(TextField.prototype,"TextField");var Sprite=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.Sprite);__reflect(Sprite.prototype,"Sprite");var Shape=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.Shape);__reflect(Shape.prototype,"Shape");var DisplayObject=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.DisplayObject);__reflect(DisplayObject.prototype,"DisplayObject");var DisplayObjectContainer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(DisplayObjectContainer.prototype,"DisplayObjectContainer");var Point=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.Point);__reflect(Point.prototype,"Point");var Rectangle=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.Rectangle);__reflect(Rectangle.prototype,"Rectangle");var Bitmap=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.Bitmap);__reflect(Bitmap.prototype,"Bitmap");var BitmapData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.BitmapData);__reflect(BitmapData.prototype,"BitmapData");var Stage=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.Stage);__reflect(Stage.prototype,"Stage");var Tween=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.Tween);__reflect(Tween.prototype,"Tween");var Ease=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.Ease);__reflect(Ease.prototype,"Ease");var trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i="",n=0;n<t.length;n++)i+=t[n]+",";i=i.substr(0,i.length-1),moon.LogManager.getIns().logMessage(i)},traceSimple=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i="",n=0;n<t.length;n++)i+=t[n]+",";i=i.substr(0,i.length-1),moon.LogManager.getIns().log(i)},alertAuto=function(t,e){void 0===t&&(t="提示或警告"),void 0===e&&(e=3),moon.AlertManager.getIns().alertAuto(t,e)},alertHand=function(t){void 0===t&&(t="提示或警告"),moon.AlertManager.getIns().alert(t)},alertRoll=function(t,e){void 0===t&&(t="提示或警告"),void 0===e&&(e=200),moon.AlertManager.getIns().alertRoll(t,e)},moon;!function(t){var e=function(){function t(){}return t.gameSceneSetting=[{specialBox:!1,banner:!1,award:!1,backgroud:!1,popUp:!1},{specialBox:!1,banner:!0,award:!1,backgroud:!1,popUp:!1},{specialBox:!1,banner:!1,award:!0,backgroud:!1,popUp:!1},{specialBox:!1,banner:!1,award:!1,backgroud:!0,popUp:!1},{specialBox:!1,banner:!1,award:!1,backgroud:!1,popUp:!0},{specialBox:!0,banner:!1,award:!1,backgroud:!1,popUp:!1}],t}();t.GAMETYPE=e,__reflect(e.prototype,"moon.GAMETYPE");var i=function(){function t(){}return t.fontName="黑体",t}();t.FONT=i,__reflect(i.prototype,"moon.FONT");var n=function(){function t(){}return t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t.SHAPE_RECT="shape rect",t.SHAPE_RECT_ROUND="shape rect round",t.SHAPE_CIRCLE="shape circle",t.VER_DEBUG="debug",t.VER_RELEASE="release",t}();t.Const=n,__reflect(n.prototype,"moon.Const");var o=function(){function t(){}return Object.defineProperty(t,"random",{get:function(){return 16777215*Math.random()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"white",{get:function(){return 16777215},enumerable:!0,configurable:!0}),Object.defineProperty(t,"black",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gray",{get:function(){return 6710886},enumerable:!0,configurable:!0}),Object.defineProperty(t,"red",{get:function(){return 16711680},enumerable:!0,configurable:!0}),Object.defineProperty(t,"green",{get:function(){return 65280},enumerable:!0,configurable:!0}),Object.defineProperty(t,"bule",{get:function(){return 255},enumerable:!0,configurable:!0}),Object.defineProperty(t,"skinNormal",{get:function(){return 1382684},enumerable:!0,configurable:!0}),Object.defineProperty(t,"skinDown",{get:function(){return 10066329},enumerable:!0,configurable:!0}),Object.defineProperty(t,"titleBackground",{get:function(){return 2106923},enumerable:!0,configurable:!0}),t.getRandomArray=function(t){for(var e=[],i=0;t>i;i++)e.push(16777215*Math.random());return e},t.lightenDarkenColor=function(t,e){var i=(t>>16)+e;i>255?i=255:0>i&&(i=0);var n=(t>>8&255)+e;n>255?n=255:0>n&&(n=0);var o=(255&t)+e;return o>255?o=255:0>o&&(o=0),o|n<<8|i<<16},t}();t.Color=o,__reflect(o.prototype,"moon.Color");var a=function(){function e(){}return Object.defineProperty(e,"randomRect",{get:function(){return t.MoonUI.getRect(60,60,t.Color.random)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"randomCircle",{get:function(){return t.MoonUI.getCircle(50,t.Color.random)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pointNormal",{get:function(){return t.MoonUI.getCircle(6,t.Color.black)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pointDown",{get:function(){return t.MoonUI.getCircle(6,t.Color.gray)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"buttonNormal",{get:function(){return t.MoonUI.getRect(60,60,t.Color.skinNormal)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"buttonDown",{get:function(){return t.MoonUI.getRect(60,60,t.Color.skinDown)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"radioOff",{get:function(){return t.MoonUI.getRadioCircle(t.Color.white,t.Color.white)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"radioOn",{get:function(){return t.MoonUI.getRadioCircle(t.Color.white,t.Color.black,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"checkBoxOff",{get:function(){return t.MoonUI.getCheckBoxRect(t.Color.white,t.Color.white)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"checkBoxOn",{get:function(){return t.MoonUI.getCheckBoxRect(t.Color.white,t.Color.black,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"switchOff",{get:function(){return t.MoonUI.getSwitch(t.Color.skinNormal,t.Color.white)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"switchOn",{get:function(){return t.MoonUI.getSwitch(t.Color.skinNormal,t.Color.white,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"progressBackground",{get:function(){return t.MoonUI.getRect(300,20,t.Color.skinNormal)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"progressValue",{get:function(){return t.MoonUI.getRect(300,20,t.Color.skinDown)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sliderBackground",{get:function(){return t.MoonUI.getRect(300,10,t.Color.skinNormal)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sliderValue",{get:function(){return t.MoonUI.getRect(300,10,t.Color.skinDown)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sliderBar",{get:function(){return t.MoonUI.getCircle(15,t.Color.white)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scrollBar",{get:function(){return t.MoonUI.getRect(10,10,t.Color.skinNormal)},enumerable:!0,configurable:!0}),e.getRodatioButton=function(e){var i=new x(t.Skin.radioOff,t.Skin.radioOn);return i.skinAutoScale=!1,i.label=e,i.labelColor=t.Color.black,i.setLabelPoint(40,0),i},e.getCheckBox=function(e){var i=[t.Skin.checkBoxOff,t.Skin.checkBoxOff,t.Skin.checkBoxOn,t.Skin.checkBoxOn],n=new t.MoreSkinButton(i);return n.skinAutoScale=!1,n.label=e,n.toggleSwitch=!0,n.labelColor=t.Color.black,n.setLabelPoint(50,2),n},e}();t.Skin=a,__reflect(a.prototype,"moon.Skin");var r=function(){function t(){}return t.displayRank=function(t,e,i,n,o,a,r){void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===r&&(r=1);for(var s,h=0;h<t.length;h++)s=t[h],s.x=o+Math.floor(h%e)*(s.width+i)*r,s.y=a+Math.floor(h/e)*(s.height+n)*r},t}();t.SimpleLayout=r,__reflect(r.prototype,"moon.SimpleLayout");var s=function(){function e(){}return Object.defineProperty(e,"randomColor",{get:function(){return 16777215*Math.random()},enumerable:!0,configurable:!0}),e.getLineRect=function(t,e,i,n,o,a){void 0===i&&(i=0),void 0===n&&(n=1),void 0===o&&(o=0),void 0===a&&(a=0);var r=new Sprite;return r.graphics.lineStyle(n,i),r.graphics.drawRect(o,a,t,e),r.graphics.endFill(),r},e.getLineCircle=function(t,e,i,n,o){void 0===e&&(e=0),void 0===i&&(i=1),void 0===n&&(n=0),void 0===o&&(o=0);var a=new Sprite;return a.graphics.lineStyle(i,e),a.graphics.drawCircle(n,o,t),a.graphics.endFill(),a},e.getMatrixRect=function(t,e,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0);var a=new Sprite,r=new egret.Matrix;return r.createGradientBox(t,e,Math.PI*o,0,0),a.graphics.beginGradientFill(egret.GradientType.LINEAR,[i,n],[1,1],[0,255],r),a.graphics.drawRect(0,0,t,e),a.graphics.endFill(),a},e.getRect=function(t,e,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0);var a=new Sprite;return a.graphics.beginFill(i),a.graphics.drawRect(n,o,t,e),a.graphics.endFill(),a},e.getRectAndX=function(t,e,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0);var a=this.getRect(t,e,i,n,o);return a.addChild(this.getX(t,e,i,1,n,o)),a},e.getX=function(t,e,i,n,o,a){void 0===i&&(i=0),void 0===n&&(n=1),void 0===o&&(o=0),void 0===a&&(a=0);var r=new Sprite,s=new Sprite;s.graphics.lineStyle(n,i),s.graphics.moveTo(0,0),s.graphics.lineTo(t,e);var h=new Sprite;return h.graphics.lineStyle(n,i),h.graphics.moveTo(t,0),h.graphics.lineTo(0,e),r.addChild(s),r.addChild(h),r},e.getRoundRect=function(t,e,i,n,o,a,r){void 0===i&&(i=0),void 0===n&&(n=5),void 0===o&&(o=5),void 0===a&&(a=0),void 0===r&&(r=0);var s=new Sprite;return s.graphics.beginFill(i),s.graphics.drawRoundRect(a,r,t,e,n,o),s.graphics.endFill(),s},e.getCircle=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var o=new Sprite;return o.graphics.beginFill(e),o.graphics.drawCircle(i,n,t),o.graphics.endFill(),o},e.getPolygon=function(t,e,i,n){void 0===t&&(t=3),void 0===e&&(e=10),void 0===i&&(i=0),void 0===n&&(n=0);var o=new Sprite;o.rotation=n,o.graphics.beginFill(i);for(var a=0;t>=a;a++){var r=Math.cos(a*(360/t)*Math.PI/180)*e,s=Math.sin(a*(360/t)*Math.PI/180)*e;0==a?o.graphics.moveTo(r,s):o.graphics.lineTo(r,s)}return o.graphics.endFill(),o},e.getArrowRoundRect=function(t,e,i,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var a=new Sprite;a.addChild(this.getRoundRect(t,e,i));var r=this.getPolygon(3,t/3,n,30+o);return r.x=a.width>>1,r.y=a.height>>1,a.addChild(r),a},e.getScrollLineBar=function(t,e,i){for(var n=new Sprite,o=e/3,a=0;3>a;a++){var r=this.getRect(t,1,i,0,a*o);n.addChild(r)}return n},e.getAddRoundRect=function(t,e,i){var n=new Sprite;n.addChild(this.getRoundRect(t,e,i));var o=this.getRect(t/2,2,0,t/4,e/2-1),a=this.getRect(2,e/2,0,t/2-1,e/4);return n.addChild(o),n.addChild(a),n},e.getRemoveRoundRect=function(t,e,i){var n=new Sprite;n.addChild(this.getRoundRect(t,e,i));var o=this.getRect(t/2,2,0,t/4,e/2-1);return n.addChild(o),n},e.getRoundRectText=function(t,e,i,n){void 0===n&&(n="click");var o=new Sprite;o.addChild(this.getRoundRect(t,e,i));var a=new TextField;return a.name="text",a.text=n,a.x=o.width-a.width>>1,a.y=o.height-a.height>>1,o.addChild(a),o},e.getSwitch=function(e,i,n){void 0===e&&(e=16777215),void 0===i&&(i=0),void 0===n&&(n=0);var o=t.MoonUI.getRoundRect(80,50,e,60,60);return o.addChild(t.MoonUI.getCircle(22,i,0==n?25:55,25)),o},e.getCheckBoxRect=function(t,e,i){void 0===t&&(t=16777215),void 0===e&&(e=0),void 0===i&&(i=0);var n=new Sprite;if(n.addChild(this.getRect(40,40,t)),1==i){var o=new Sprite;o.graphics.beginFill(e),o.graphics.moveTo(0,20),o.graphics.lineTo(20,36),o.graphics.lineTo(44,8),o.graphics.lineTo(36,0),o.graphics.lineTo(20,18),o.graphics.lineTo(12,8),o.graphics.lineTo(0,20),n.addChild(o)}return n},e.getRadioCircle=function(t,e,i){void 0===t&&(t=16777215),void 0===e&&(e=0),void 0===i&&(i=0);var n=new Sprite;if(n.addChild(this.getCircle(16,t,16,16)),n.graphics.lineStyle(1,0),1==i){var o=this.getCircle(8,e,16,16);n.addChild(o)}return n},e.getGridding=function(t,e){void 0===e&&(e=0);var i=new Sprite;i.graphics.lineStyle(.1,e);for(var n=t.width/t.x,o=t.height/t.y,a=0;a<t.x;a++)i.graphics.moveTo(0,a*o),i.graphics.lineTo(t.width,a*o);for(a=0;a<t.y;a++)i.graphics.moveTo(a*n,0),i.graphics.lineTo(a*n,t.height);return i},e.getHeart=function(t,e){void 0===t&&(t=15),void 0===e&&(e=16711680);var i=new Sprite;return i.graphics.beginFill(e),i.graphics.moveTo(0,0),i.graphics.lineTo(0,2*-t),i.graphics.cubicCurveTo(t,2.5*-t,2*t,1.5*-t,0,0),i.graphics.moveTo(0,0),i.graphics.lineTo(0,2*-t),i.graphics.cubicCurveTo(-t,2.5*-t,2*-t,1.5*-t,0,0),i.graphics.endFill(),i.anchorOffsetX=-i.width/2,i.anchorOffsetY=-i.height,i},e}();t.MoonUI=s,__reflect(s.prototype,"moon.MoonUI");var h=function(){function t(){}return t.getIns=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.init=function(t){var e=(new y).textField;e.textAlign=egret.HorizontalAlign.LEFT,t.addChild(e),this.txtSimple=e;var e=(new y).textField;e.size=25,t.addChild(e),this.txtMessage=e},t.prototype.debug=function(t){this.txtSimple.text=t},t.prototype.log=function(t){G.version==n.VER_DEBUG&&(this.txtSimple.text=t)},t.prototype.logMessage=function(t){G.version==n.VER_DEBUG&&this.txtMessage.appendText(t+"\n")},t.prototype.setLogColor=function(t){this.txtSimple.textColor=t},t.prototype.setLogMessageColor=function(t){this.txtMessage.textColor=t},t}();t.LogManager=h,__reflect(h.prototype,"moon.LogManager");var l=function(){function t(){}return t.getIns=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.init=function(t){this.stage=t},t.prototype.alertAuto=function(t,e){void 0===t&&(t="自动关闭的提示或警告"),void 0===e&&(e=3);var i=new I(t,e);return this.stage?this.stage.addChild(i):trace("调用alertAuto时请先执行AlertManager的init初始化函数"),i},t.prototype.alert=function(t){void 0===t&&(t="手动关闭的提示或警告");var e=new D(t);return this.stage?this.stage.addChild(e):trace("调用alertAuto时请先执行AlertManager的init初始化函数"),e},t.prototype.alertRoll=function(t,e){void 0===t&&(t="提示或警告"),void 0===e&&(e=200);var i=new k(t,e);return this.stage?this.stage.addChild(i):trace("调用alertAuto时请先执行AlertManager的init初始化函数"),i},t}();t.AlertManager=l,__reflect(l.prototype,"moon.AlertManager");var d=function(){function e(){this.bgName="tips_png"}return e.getIns=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.init=function(t){this.stage=t},e.prototype.simpleTips=function(e,i){null==this.tipsView&&(this.tipsView=new t.BasicTips(this.bgName),this.tipsView.setValue(e),this.stage.addChild(this.tipsView),this.setPosition(i),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.removeTips,this))},e.prototype.setPosition=function(t){t&&(this.tipsView.x=t.x-(this.tipsView.width>>1),this.tipsView.y=t.y-2*this.tipsView.height,this.tipsView.y<0&&(this.tipsView.y=t.y),this.tipsView.y+this.tipsView.height>this.stage.stageHeight&&(this.tipsView.y=t.y-(this.tipsView.height+50)),this.tipsView.x<0&&(this.tipsView.x=t.x+50),this.tipsView.x+this.tipsView.width>this.stage.stageWidth&&(this.tipsView.x=t.x-(this.tipsView.width+50)))},e.prototype.removeTips=function(){this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.removeTips,this);var t=this.tipsView.parent;null!=t&&(t.removeChild(this.tipsView),this.tipsView=null)},e}();t.TipsManager=d,__reflect(d.prototype,"moon.TipsManager");var c=function(t){function e(e,i,n){void 0===e&&(e=""),void 0===i&&(i=null),void 0===n&&(n=null);var o=t.call(this)||this;return o.type=e,o.data=i,o.currentTarget=n,o}return __extends(e,t),e.MOUSE_OVER="event-over",e.MOUSE_OUT="event-out",e.MOUSE_DOWN="event-down",e.MOUSE_MOVE="event-move",e.MOUSE_UP="event-up",e.CLICK="event-click",e.CHANGE="change",e.COMPLETE="complete",e.RENDER_COMPLETE="render complete",e.UPDATE="update",e.START="start",e.MOVE="move",e.OVER="over",e.PAUSE="pause",e.STOP="stop",e.PLAY="play",e.OPEN="open",e.CLOSE="close",e}(egret.EventDispatcher);t.MoonEvent=c,__reflect(c.prototype,"moon.MoonEvent");var u=function(t){function e(){var e=t.call(this)||this;return e._type=n.SHAPE_RECT,e._color=0,e.display=new Sprite,e.bg=new Sprite,e}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t,this._data.c=t,this.draw()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{set:function(t){this._data=t,this.draw()},enumerable:!0,configurable:!0}),e.prototype.draw=function(){this._color=this._data.c,this.display.graphics.clear(),this.display=this.getDisplay(this._data),this.addChild(this.display),this.setPosition()},e.prototype.setPosition=function(){this._hasBg&&this.type!=n.SHAPE_CIRCLE&&(this.display.x=this.bg.width-this.display.width>>1,this.display.y=this.bg.height-this.display.height>>1)},e.prototype.setBackground=function(t,e){void 0===e&&(e=1),this._hasBg=!0;var i=this._data,n={};for(var o in i)n[o]=i[o];n.c=t,n.w&&(n.w=n.w+2*e),n.h&&(n.h=n.h+2*e),n.r&&(n.r=n.r+e),this.bg.graphics.clear(),this.bg=this.getDisplay(n),this.addChildAt(this.bg,0),this.setPosition()},e.prototype.getDisplay=function(t){switch(this.type){case n.SHAPE_RECT:return s.getRect(t.w,t.h,t.c);case n.SHAPE_RECT_ROUND:return s.getRoundRect(t.w,t.h,t.c,t.ew,t.eh);case n.SHAPE_CIRCLE:return s.getCircle(t.r,t.c)}},e}(Sprite);t.MoonDisplayObject=u,__reflect(u.prototype,"moon.MoonDisplayObject");var p=function(t){function e(){var e=t.call(this)||this;return e.dataEvent=new Object,e.init(),e.once(egret.Event.ADDED_TO_STAGE,e.addToStage,e),e}return __extends(e,t),e.prototype.addToStage=function(){this.render()},e.prototype.init=function(){},e.prototype.render=function(){this.stageWidth=this.stage.stageWidth,this.stageHeight=this.stage.stageHeight},e.prototype.dispEvent=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),this.dataEvent){var n=this.dataEvent[t];if(null!=n){var o=new c;o.currentTarget=this,o.data=e,o.type=t,o.dataType=i,n["this"]?n.apply(n["this"],[o]):n(o)}}},e.prototype.addEvent=function(t,e,i){void 0===i&&(i=null),this.dataEvent&&null==this.dataEvent[t]&&(e["this"]=i,this.dataEvent[t]=e)},e.prototype.removeEvent=function(t,e){this.dataEvent&&this.dataEvent[t]&&delete this.dataEvent[t]},e.prototype.removeFromParent=function(t){void 0===t&&(t=!1);var e=this.parent;t&&this.dispose(),e&&e.contains(this)&&e.removeChild(this),e=null},e.prototype.removeChildAll=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=2147483647),void 0===i&&(i=!1),(0>e||e>=this.numChildren)&&(e=this.numChildren-1);for(var n=t;e>=n;++n)this.removeChildIndex(t,i)},e.prototype.removeChildIndex=function(t,i){if(t>=0||t<this.numChildren){var n=this.getChildAt(t);if(n instanceof e)n.removeFromParent(i);else{var o=this.getChildAt(t);o.parent&&o.parent.removeChild(o)}}},e.prototype.dispose=function(){this.removeChildAll(0,-1,!0),this.dataEvent=null,this.stageWidth=null,this.stageHeight=null},e}(DisplayObjectContainer);t.MoonContainer=p,__reflect(p.prototype,"moon.MoonContainer");var g=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.createText=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i="");var n=(new y).textField;return n.x=t,n.y=e,n.text=i,this.addChild(n),n},i.prototype.createRect=function(e,i,n,o,a){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0);var r=t.MoonUI.getRect(e,i,n,o,a);return this.addChild(r),r},i.prototype.createCircle=function(e,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0);var a=t.MoonUI.getCircle(e,i,n,o);return this.addChild(a),a},i.prototype.createRectBySprite=function(t,e,i,n,o,a){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0),t.graphics.clear(),t.graphics.beginFill(n),t.graphics.drawRect(o,a,e,i),t.graphics.endFill()},i.prototype.createBackground=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1);var i=this.createRect(this.stageWidth,this.stageHeight,t);return i.alpha=e,i.touchEnabled=!0,i},i.prototype.createBgGradientFill=function(t,e){void 0===t&&(t=96963),void 0===e&&(e=14540253);var i=this.stageWidth,n=this.stageHeight,o=new egret.Matrix;o.createGradientBox(i,n,Math.PI/2);var a=new Sprite;return a.graphics.beginGradientFill(egret.GradientType.LINEAR,[t,e],[1,1],[0,255],o),a.graphics.drawRect(0,0,i,n),this.addChild(a),a},i}(p);t.BasicView=g,__reflect(g.prototype,"moon.BasicView");var v=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.play=function(){this.stop(),this.isPlay=!0,egret.startTick(this.loop,this)},i.prototype.stop=function(){this.isPlay=!1,egret.stopTick(this.loop,this)},i.prototype.loop=function(t){return traceSimple(t),!0},i.prototype.createButton=function(e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var o=new t.BasicButton;return o.label=e,o.x=i,o.y=n,this.addChild(o),o},i}(g);t.GameView=v,__reflect(v.prototype,"moon.GameView");var m=function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this)||this;return RES.hasRes(e)?(n.texture=RES.getRes(e),n.scale9Grid=i||new Rectangle(8,8,2,2)):egret.error("找不到资源："+e),n}return __extends(e,t),e}(Bitmap);t.Scale9Image=m,__reflect(m.prototype,"moon.Scale9Image");var f=function(t){function e(e){var i=t.call(this)||this;return i.side=14,i.lineSpacing=4,i.image=new m(e),i.addChild(i.image),i.text=(new y).textField,i.text.textAlign=egret.HorizontalAlign.CENTER,i.text.verticalAlign=egret.VerticalAlign.MIDDLE,i.text.lineSpacing=i.lineSpacing,i.addChild(i.text),i}return __extends(e,t),e.prototype.setValue=function(t){this.text.text=t,this.setCenter()},e.prototype.setTextFlow=function(t){this.text.textFlow=t,this.setCenter()},e.prototype.setCenter=function(){var t=this.image,e=this.text,i=this.side,n=e.width+i,o=e.height+i;t.width=n,t.height=o,e.x=e.y=i>>1},e}(p);t.BasicTips=f,__reflect(f.prototype,"moon.BasicTips");var y=function(e){function i(i,n){void 0===i&&(i=""),void 0===n&&(n=16777215);var o=e.call(this)||this;return o.text=new TextField,o.text.textAlign=egret.HorizontalAlign.LEFT,o.text.verticalAlign=egret.VerticalAlign.MIDDLE,o.text.text=i,o.text.textColor=n,o.text.fontFamily=t.FONT.fontName,o.addChild(o.text),o}return __extends(i,e),Object.defineProperty(i.prototype,"textField",{get:function(){return this.text},enumerable:!0,configurable:!0}),i}(p);t.Label=y,__reflect(y.prototype,"moon.Label");var x=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=t.call(this)||this;return n.skinAutoScale=!0,n.statusNormal=e||a.buttonNormal,n.statusDown=i||a.buttonDown,n.skinContainer=new DisplayObjectContainer,n.addChild(n.skinContainer),n.updateSkin(n.statusNormal),n.text=(new y).textField,n.addChild(n.text),n.open(),n}return __extends(e,t),e.prototype.open=function(){this.close(),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouch,this)},e.prototype.close=function(){this.touchEnabled=!1,this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouch,this),this.stage&&this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this)},e.prototype.setLabelPoint=function(t,e){this.text.anchorOffsetX=0,this.text.anchorOffsetY=0,this.text.x=t,this.text.y=e},Object.defineProperty(e.prototype,"labelCircle",{set:function(t){this.text.text=t,this.skinAutoScale=!1,this.text.x=this.text.y=0,this.text.anchorOffsetX=this.text.textWidth>>1,this.text.anchorOffsetY=this.text.textHeight>>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelColor",{set:function(t){this.text.textColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this.text.text},set:function(t){this.text.text=t;this.text.width+20;this.setSkinSize(),this.setTextPosition()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textFild",{get:function(){return this.text},enumerable:!0,configurable:!0}),e.prototype.setTextFlow=function(t){this.text.textFlow=t,this.setSkinSize(),this.setTextPosition()},e.prototype.setSkinNormal=function(){this.updateSkin(this.statusNormal)},e.prototype.setSkinDown=function(){this.updateSkin(this.statusDown)},e.prototype.onTouch=function(t){t.type==egret.TouchEvent.TOUCH_BEGIN?(this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this.updateSkin(this.statusDown)):(this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this.updateSkin(this.statusNormal)),this.dispEvent(c.CLICK)},Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.text.width+20},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.text.height+20},enumerable:!0,configurable:!0}),e.prototype.setSkinSize=function(){if(this.skinAutoScale&&""!=this.text.text){var t=this.textWidth/this.statusNormal.width;this.statusNormal instanceof Bitmap?(this.statusNormal.width=this.textWidth,this.statusDown.width=this.textWidth):this.statusNormal.scaleX=this.statusDown.scaleX=t;var e=this.textHeight;e>=this.statusNormal.height&&(t=e/this.statusNormal.height,this.statusNormal instanceof Bitmap?(this.statusNormal.height=this.textHeight,this.statusDown.height=this.textHeight):this.statusNormal.scaleY=this.statusDown.scaleY=t)}},e.prototype.setTextPosition=function(){this.text.anchorOffsetX=this.text.width>>1,this.text.anchorOffsetY=this.text.height>>1,this.textWidth>this.statusNormal.width?this.text.x=this.textWidth>>1:this.text.x=this.statusNormal.width>>1,this.textHeight>this.statusNormal.height?this.text.y=this.textHeight>>1:this.text.y=this.statusNormal.height>>1},e.prototype.updateSkin=function(t){this.skinContainer.removeChildren(),this.skinContainer.addChild(t)},e.prototype.dispose=function(){this.close(),t.prototype.dispose.call(this)},e}(p);t.BasicButton=x,__reflect(x.prototype,"moon.BasicButton",["moon.IOnoff"]);var _=function(t){function e(e){var i=t.call(this,e[0],e[1])||this;return i._currentPage=0,i.skins=e,i}return __extends(e,t),e.prototype.updatePage=function(t){this.currentPage=t,this.setSkinNormal()},Object.defineProperty(e.prototype,"currentPage",{get:function(){return this._currentPage},set:function(t){t=2*t==this.skins.length?0:t,this._currentPage=t,this.statusNormal=this.skins[2*t],this.statusDown=this.skins[2*t+1],this.setSkinSize()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toggleSwitch",{set:function(t){this._toggleSwitch=t},enumerable:!0,configurable:!0}),e.prototype.onTouch=function(e){e.type==egret.TouchEvent.TOUCH_END&&this._toggleSwitch&&(this.currentPage=1-this.currentPage),t.prototype.onTouch.call(this,e)},e}(x);t.MoreSkinButton=_,__reflect(_.prototype,"moon.MoreSkinButton");var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.items=[],e.index=0,e}return __extends(e,t),e.prototype.addItem=function(t){this.items.push(t)},e.prototype.removeItem=function(t){var e=this.items.indexOf(t);e>=0&&this.items.splice(e,1)},e.prototype.hasItem=function(t){return this.items.length>0&&t>=0&&t<this.items.length},e.prototype.getItem=function(t){return this.items[t]},e.prototype.getNextItem=function(){return this.items[this.index++]},e.prototype.reset=function(){this.index=0},e.prototype.update=function(){},e.prototype.dispose=function(){for(this.reset();this.hasItem(this.index);){var t=this.getItem(this.index);this.removeItem(t),t instanceof p&&t.removeFromParent(!0)}},e}(g);t.BasicBar=w,__reflect(w.prototype,"moon.BasicBar",["moon.IItem"]);var C=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var n=t.call(this)||this;return n._value=0,n.setSkin(e,i),n.addChild(n.skinBg),n.addChild(n.skinValue),n.text=(new y).textField,n.addChild(n.text),n}return __extends(e,t),e.prototype.setSkin=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.skinBg=t||a.progressBackground,this.skinValue=e||a.progressValue},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){t=0>t?0:t>1?1:t,this._value=t,this.skinValue.scaleX=t},enumerable:!0,configurable:!0}),e.prototype.showText=function(t,e,i){void 0===e&&(e=-1),void 0===i&&(i=-1),this.text.text=t,-1==e?this.text.x=this.skinBg.width-this.text.width>>1:this.text.x=e,-1==i?this.text.y=this.skinBg.height+5:this.text.y=i},e}(p);t.ProgressBar=C,__reflect(C.prototype,"moon.ProgressBar");var b=function(t){function e(e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=null);var o=t.call(this,e,i)||this;return o.skinBar=n||a.sliderBar,o.addChild(o.skinBar),o.skinBar.addEventListener(egret.TouchEvent.TOUCH_BEGIN,o.onTouch,o),o.skinBar.touchEnabled=!0,o.layout(),o.value=1,o}return __extends(e,t),e.prototype.setSkin=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.skinBg=t||a.sliderBackground,this.skinValue=e||a.sliderValue},e.prototype.onTouch=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouch,this),this.dispEvent(c.START);break;case egret.TouchEvent.TOUCH_MOVE:this.moveDo(t.stageX,t.stageY),this.dispEvent(c.MOVE);break;case egret.TouchEvent.TOUCH_END:this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouch,this),this.dispEvent(c.OVER)}},e.prototype.moveDo=function(t,e){var i,o=this.globalToLocal(t,e);i=this.type==n.HORIZONTAL?o.x/this.skinValue.width:-o.y/this.skinValue.width,this.value=i},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){t=0>t?0:t>1?1:t,this._value=t,this.skinValue.scaleX=t,this.type==n.HORIZONTAL?this.skinBar.x=this.skinValue.width*t:this.skinBar.y=-this.skinValue.width*t},enumerable:!0,configurable:!0}),e.prototype.layout=function(t,e){if(void 0===t&&(t=n.HORIZONTAL),void 0===e&&(e=0),this.type=t,t==n.VERTICAL){var i=-90;this.skinBar.x=this.skinValue.height>>1}else{var i=0;
this.skinBar.y=this.skinValue.height>>1}this.skinBg.rotation=i,this.skinValue.rotation=i},e}(C);t.SliderBar=b,__reflect(b.prototype,"moon.SliderBar",["moon.ILayout"]);var T=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.skinBar=e||a.scrollBar,i.skinBar.alpha=0,i.addChild(i.skinBar),i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,i.onTouch,i),i.touchEnabled=!0,i.startPos=new Point,i.stPos=new Point,i.setSize(),i.layout(),i}return __extends(e,t),e.prototype.onTouch=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouch,this),this.stPos.x=t.stageX,this.stPos.y=t.stageY,this.startPos.x=t.stageX-this._target.x,this.startPos.y=t.stageY-this._target.y,this.hideShow(1),this.startTime=egret.getTimer();break;case egret.TouchEvent.TOUCH_MOVE:this.moveDo(t.stageX,t.stageY);break;case egret.TouchEvent.TOUCH_END:this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouch,this),this.hideShow(0,100),this.timeMove(t.stageX,t.stageY)}},e.prototype.timeMove=function(t,e){var i=egret.getTimer()-this.startTime;if(500>i){var o=this._target,a=this.maskRect;Tween.removeTweens(o);var r=t-this.stPos.x,s=e-this.stPos.y,h=Math.sqrt(r*r+s*s),l=h/i*100,d=Tween.get(o);if(this.type==n.VERTICAL){var c=s>0?1:-1;l*=c;var u=o.y+l;u>0&&o.y+l>0&&(u=0),0>u&&o.y+l<a.height-o.height&&(u=a.height-o.height),d.to({y:u},400,Ease.sineOut).call(this.setBarPos,this)}else{var c=r>0?1:-1;l*=c;var p=o.x+l;p>0&&o.x+l>0&&(p=0),0>p&&o.x+l<a.width-o.width&&(p=a.width-o.width),d.to({x:p},400,Ease.sineOut).call(this.setBarPos,this)}}},e.prototype.setBarPos=function(){this.type==n.VERTICAL?this.skinBar.y=-this._target.y/(this._target.height-this.maskRect.height)*(this.maskRect.height-this.skinBar.height):this.skinBar.x=-this._target.x/(this._target.width-this.maskRect.width)*(this.maskRect.width-this.skinBar.width)},e.prototype.hideShow=function(t,e){void 0===e&&(e=1e3),Tween.removeTweens(this.skinBar),1==t&&(this.skinBar.alpha=1);var i=Tween.get(this.skinBar);i.to({alpha:t},e)},e.prototype.moveDo=function(t,e){this.type==n.VERTICAL?this.canMoveY(e):this.type==n.HORIZONTAL&&this.canMoveX(t)},e.prototype.canMoveX=function(t){var e=this.maskRect.width-this._target.width,i=t-this.startPos.x;i>e&&0>i&&(this._target.x=i,this.skinBar.x=-i/(this._target.width-this.maskRect.width)*(this.maskRect.width-this.skinBar.width))},e.prototype.canMoveY=function(t){var e=this.maskRect.height-this._target.height,i=t-this.startPos.y;i>e&&0>i&&(this._target.y=i,this.skinBar.y=-i/(this._target.height-this.maskRect.height)*(this.maskRect.height-this.skinBar.height))},e.prototype.setMask=function(){null!=this.maskRect&&null!=this._target&&(this._target.mask=this.maskRect)},e.prototype.setSkinBarPos=function(){this.skinBar.x=this.skinBar.y=0,this.type==n.VERTICAL?this.skinBar.x=this.maskRect.width-this.skinBar.width:this.type==n.HORIZONTAL&&(this.skinBar.y=this.maskRect.height-this.skinBar.height)},e.prototype.layout=function(t,e){void 0===t&&(t=n.VERTICAL),void 0===e&&(e=0),this.type=t,this.setSkinBarPos()},e.prototype.setSize=function(t,e){void 0===t&&(t=200),void 0===e&&(e=200),this.maskRect=s.getRect(t,e),this.addChild(this.maskRect),this.setMask(),this.setSkinBarPos()},Object.defineProperty(e.prototype,"target",{set:function(t){this._target=t,this.addChildAt(this._target,0),this.setMask()},enumerable:!0,configurable:!0}),e}(p);t.ScrollBar=T,__reflect(T.prototype,"moon.ScrollBar",["moon.ILayout"]);var E=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.addItemLabel=function(t,e){void 0===e&&(e=null),null==e?e=a.getCheckBox(t):e.label=t,this.addItem(e)},i.prototype.addItem=function(t){e.prototype.addItem.call(this,t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.addChild(t)},i.prototype.removeItem=function(t){e.prototype.removeItem.call(this,t),t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),t.removeFromParent(!0)},i.prototype.onClick=function(e){e.currentTarget;this.dispEvent(t.MoonEvent.CHANGE)},i.prototype.layout=function(t,e){void 0===t&&(t=n.VERTICAL),void 0===e&&(e=10);for(var i=0;i<this.items.length;i++){var o=this.items[i];t==n.VERTICAL?o.y=(o.height+e)*i:o.x=(o.width+e)*i}},Object.defineProperty(i.prototype,"selectIndexs",{get:function(){for(var t=[],e=0;e<this.items.length;e++){var i=this.items[e];1==i.currentPage&&t.push(e)}return t},enumerable:!0,configurable:!0}),i}(w);t.CheckBoxBar=E,__reflect(E.prototype,"moon.CheckBoxBar",["moon.ILayout"]);var S=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._selectIndex=0,t}return __extends(i,e),i.prototype.onClick=function(t){var e=t.currentTarget;this.selectItem(e)},i.prototype.selectItem=function(e){for(this.reset();this.hasItem(this.index);){var i=this.getNextItem();i.currentPage=0,i.setSkinNormal(),i.open()}e.close(),e.currentPage=1,e.setSkinNormal(),this._selectIndex=this.items.indexOf(e),this.dispEvent(t.MoonEvent.CHANGE,this._selectIndex)},Object.defineProperty(i.prototype,"selectIndex",{get:function(){return this._selectIndex},set:function(t){this._selectIndex=t,this.selectItem(this.getItem(t))},enumerable:!0,configurable:!0}),i}(E);t.TabbarBar=S,__reflect(S.prototype,"moon.TabbarBar");var B=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.isAutoLayout=!1,t}return __extends(i,e),i.prototype.addItemLabel=function(t,e){void 0===e&&(e=null),null==e?e=a.getRodatioButton(t):e.label=t,this.addItem(e)},i.prototype.render=function(){this.update()},i.prototype.update=function(){var t;if(1==this.isAutoLayout)for(var e=0;e<this.items.length;e++)t=this.items[e],t.x=(t.width+10)*e},i.prototype.onClick=function(e){var i=e.currentTarget;this.selectIndex=this.items.indexOf(i),this.dispEvent(t.MoonEvent.CHANGE)},Object.defineProperty(i.prototype,"selectIndex",{get:function(){return this._selectIndex},set:function(t){function e(t){t.setSkinNormal()}this._selectIndex=t;var i=this.items[t];this.items.map(e,this),i.setSkinDown()},enumerable:!0,configurable:!0}),i}(E);t.RadioButtonBar=B,__reflect(B.prototype,"moon.RadioButtonBar");var D=function(t){function e(e){void 0===e&&(e="提示或警告");var i=t.call(this)||this;return i.bgColor=o.black,i.text=(new y).textField,i.text.text=e,i}return __extends(e,t),e.prototype.render=function(){t.prototype.render.call(this),this.initView()},e.prototype.initView=function(){var t=(this.createBackground(0,.3),this.text.width),e=this.text.height,i=t+80,o=e+120,a=this.stageWidth-i>>1,r=this.stageHeight-o>>1;this.bg=new u,this.bg.type=n.SHAPE_RECT_ROUND,this.bg.data={w:i,h:o,c:this.bgColor,ew:10,eh:10},this.bg.setBackground(0,2),this.bg.x=a,this.bg.y=r,this.addChild(this.bg);var s=new x;s.label="确 定",this.bg.addChild(s),s.x=i-s.width>>1,s.y=this.text.y+e+40,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.text.x=a+(i-t>>1),this.text.y=r+20,this.addChild(this.text)},e.prototype.onClick=function(t){this.removeFromParent(!0),this.dispEvent(c.CLOSE)},Object.defineProperty(e.prototype,"color",{set:function(t){this.bgColor=t,this.bg&&(this.bg.color=t)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){t.prototype.dispose.call(this),this.bg=null,this.bgColor=null,this.text=null},e}(w);t.AlertBar=D,__reflect(D.prototype,"moon.AlertBar");var I=function(t){function e(e,i){void 0===e&&(e="提示或警告"),void 0===i&&(i=3);var n=t.call(this,e)||this;return n.time=i,n}return __extends(e,t),e.prototype.initView=function(){var t=this.text.width,e=this.text.height,i=t+20,o=e+20,a=this.stageWidth-i>>1,r=this.stageHeight-o>>1;this.bg=new u,this.bg.type=n.SHAPE_RECT_ROUND,this.bg.data={w:i,h:o,c:this.bgColor,ew:10,eh:10},this.bg.setBackground(0,2),this.bg.x=a,this.bg.y=r,this.addChild(this.bg),this.text.x=a+(i-t>>1),this.text.y=r+(o-e>>1),this.addChild(this.text),this.alpha=0;var s=this.y-50;Tween.get(this).to({alpha:1},500).wait(1e3*this.time).to({alpha:0,y:s},500).call(this.backCall,this)},e.prototype.backCall=function(){Tween.removeTweens(this),this.removeFromParent(!0),this.time=null,this.dispEvent(c.CLOSE)},e}(D);t.AlertAutoBar=I,__reflect(I.prototype,"moon.AlertAutoBar");var k=function(t){function e(e,i){void 0===e&&(e="提示或警告"),void 0===i&&(i=200);var n=t.call(this,e)||this;return n.bgWidth=i,n}return __extends(e,t),e.prototype.initView=function(){var t=this.text.width,e=this.text.height,i=this.bgWidth,o=e+20,a=this.stageWidth-i>>1,r=100;this.bg=new u,this.bg.type=n.SHAPE_RECT,this.bg.data={w:i,h:o,c:this.bgColor},this.bg.x=a,this.bg.y=r,this.addChild(this.bg);var h=s.getRect(i,o,0,a,r);this.bg.mask=h,this.text.x=i,this.text.y=10,this.bg.addChild(this.text);var l=2e3+100*this.text.text.length,d=-t;Tween.get(this.text).to({x:d},l).call(this.backCall,this)},e.prototype.backCall=function(){Tween.removeTweens(this),Tween.removeTweens(this.text),this.removeFromParent(!0),this.bgWidth=null,this.dispEvent(c.CLOSE)},e}(D);t.AlertRollBar=k,__reflect(k.prototype,"moon.AlertRollBar");var M=function(t){function e(e,i){void 0===e&&(e=100),void 0===i&&(i=50);var n=t.call(this)||this;return n.text=(new y).textField,n.inputW=e,n.inputH=i,n}return __extends(e,t),e.prototype.render=function(){t.prototype.render.call(this);var e=this.inputW,i=this.inputH;this.bg=new u,this.bg.type=n.SHAPE_RECT_ROUND,this.bg.data={w:e,h:i,c:this.bgColor,ew:10,eh:10},this.bg.setBackground(0,2),this.addChild(this.bg);var o=5;this.text.x=o,this.text.y=o,this.text.width=e-2*o,this.text.height=i-2*o,this.text.type=egret.TextFieldType.INPUT,this.addChild(this.text)},e.prototype.setMultiline=function(){this.text.wordWrap=!0,this.text.multiline=!0,this.text.verticalAlign=egret.VerticalAlign.TOP},Object.defineProperty(e.prototype,"color",{set:function(t){this.bgColor=t,this.bg&&(this.bg.color=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxChars",{set:function(t){this.text.maxChars=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restrict",{set:function(t){this.text.restrict=t},enumerable:!0,configurable:!0}),e}(w);t.InputBar=M,__reflect(M.prototype,"moon.InputBar");var R=function(e){function i(t,i){void 0===t&&(t=0),void 0===i&&(i=0);var n=e.call(this)||this;return n.titleHeight=60,n.pWidth=t,n.pHeight=t,n.titleBg=new Sprite,n.containerBg=new Sprite,n.title=(new y).textField,n.container=new p,n}return __extends(i,e),i.prototype.render=function(){0==this.pWidth&&0==this.pWidth?e.prototype.render.call(this):(this.stageWidth=this.pWidth,this.stageHeight=this.pHeight),this.createRectBySprite(this.titleBg,this.stageWidth,this.titleHeight,t.Color.titleBackground),this.createRectBySprite(this.containerBg,this.stageWidth,this.stageHeight-this.titleHeight,t.Color.white,0,this.titleHeight),this.addChild(this.titleBg),this.addChild(this.containerBg),this.title.anchorOffsetX=this.title.textWidth>>1,this.title.anchorOffsetY=this.title.textHeight>>1,this.title.x=this.stageWidth>>1,this.title.y=this.titleHeight>>1,this.addChild(this.title),this.container.y=this.titleHeight,this.addChild(this.container),this.containerMask=this.createRect(this.stageWidth,this.stageHeight-this.titleHeight,t.Color.white,0,this.titleHeight),this.container.mask=this.containerMask,this.touchEnabled=!0,this.dispEvent(c.RENDER_COMPLETE)},i.prototype.addItem=function(t,i,n){void 0===i&&(i=0),void 0===n&&(n=0),e.prototype.addItem.call(this,t),0!=i&&(t.x=i),0!=n&&(t.y=n),this.container.addChild(t)},i.prototype.removeItem=function(t){e.prototype.removeItem.call(this,t),this.container.contains(t)&&this.container.removeChild(t)},Object.defineProperty(i.prototype,"label",{get:function(){return this.title.text},set:function(t){this.title.text=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"colorTop",{set:function(t){var e=this.titleBg.width,i=this.titleBg.height;this.createRectBySprite(this.titleBg,e,i,t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"colorBottom",{set:function(t){var e=this.containerBg.width,i=this.containerBg.height;this.createRectBySprite(this.containerBg,e,i,t,0,this.titleHeight)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"windowRect",{get:function(){var t=new Rectangle(0,0,this.stageWidth,this.stageHeight);return t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"topHeight",{get:function(){return this.titleHeight},enumerable:!0,configurable:!0}),i.prototype.removeAll=function(){this.container.dispose()},i}(w);t.PanelBar=R,__reflect(R.prototype,"moon.PanelBar");var A=function(e){function i(){var t=e.call(this)||this;return t.radioButton=new B,t.currentPage=0,t.posStartX=0,t.moveItems=[],t.container=new p,t.addChild(t.container),t.radioButton.isAutoLayout=!0,t}return __extends(i,e),i.prototype.open=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouch,this)},i.prototype.close=function(){this.stage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouch,this)},i.prototype.update=function(){this.container.removeChildren();var e,i;if(this.items.length>0){var n=this.items[0];this.container.addChild(n),e=n.windowRect.width,i=n.windowRect.height,this.panelWidth=e}for(var o=this.items.length,a=0;o>a;a++){var r=new x(t.Skin.pointNormal,t.Skin.pointDown);this.radioButton.addItem(r)}r=this.radioButton.getItem(0),r.setSkinDown(),this.radioButton.x=e-22*o>>1,this.radioButton.y=i-20,this.addChild(this.radioButton)},i.prototype.render=function(){this.update(),this.items.length>1&&this.open()},i.prototype.onTouch=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouch,this),this.posStartX=t.stageX,this.dispEvent(c.START);break;case egret.TouchEvent.TOUCH_MOVE:this.moveDo(t.stageX);break;case egret.TouchEvent.TOUCH_END:this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouch,this),this.moveEnd(t.stageX)}},i.prototype.moveDo=function(t){var e=t-this.posStartX;if(Math.abs(e)>20){if(0==this.moveItems.length){var i=this.items[this.currentPage],n=this.panelWidth;this.moveItems.push(i),0==this.currentPage?(i=this.items[this.currentPage+1],this.container.addChild(i),i.x=n,this.moveItems.push(i)):this.currentPage==this.items.length-1?(i=this.items[this.currentPage-1],this.container.addChild(i),i.x=-n,this.moveItems.push(i)):(i=this.items[this.currentPage-1],this.container.addChild(i),i.x=-n,this.moveItems.push(i),i=this.items[this.currentPage+1],this.container.addChild(i),i.x=n,this.moveItems.push(i))}var o=0==this.currentPage&&e>0,a=this.currentPage==this.items.length-1&&0>e;o||a||(this.container.x=e)}},i.prototype.moveEnd=function(t){if(0==this.container.x)return void this.backCall(0);var e=t-this.posStartX,i=egret.Tween.get(this.container),n=this.panelWidth,o=this.panelWidth>>2;Math.abs(e)>o?(n=this.panelWidth,n*=e>0?1:-1):(e=0,n=0);var a=200;i.to({x:n},a),i.call(this.backCall,this,[e])},i.prototype.backCall=function(t){t>0?(this.currentPage--,this.currentPage=this.currentPage<0?0:this.currentPage):0>t&&(this.currentPage++,this.currentPage=this.currentPage==this.items.length?this.items.length-1:this.currentPage),this.container.removeChildren();var e=this.items[this.currentPage];e.x=0,this.container.addChild(e),this.radioButton.selectIndex=this.currentPage,this.moveItems.length=0,this.container.x=0,this.dispEvent(c.OVER)},i.prototype.dispose=function(){e.prototype.dispose.call(this),this.close()},i}(w);t.PanelMoreManager=A,__reflect(A.prototype,"moon.PanelMoreManager",["moon.IOnoff"]);var G=function(){function t(){}return t.stageWidth=640,t.stageHeight=1136,t.FPS=60,t.version=n.VER_DEBUG,t.isMobile=egret.Capabilities.isMobile,t.gameId=1,t.score=0,t.scoreHighest=0,t.gameIndex=0,t.GAMESNUMBER=6,t.BLOOD=18,t.adver_sum=0,t.video_tap=[-1,-1,-1],t.uploadMessage=[],t.uploadUser={names:"unknown",fullscore:0,maxscore:0},t.gameType=[0,1,2,3,4,5],t.preGame=!0,t.RankList=[],t}();t.GameData=G,__reflect(G.prototype,"moon.GameData");var O=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.color=16362243,t}return __extends(i,e),i.prototype.render=function(){e.prototype.render.call(this),this.createBgGradientFill();var i=new Sprite;this.addChild(i);var n=this.stageWidth,o=this.stageHeight,a=80,r=s.getRoundRect(n-100,a,16573853,10,10);r.x=n-r.width>>1,r.y=o-r.height>>1,i.addChild(r);var h=s.getRect(n-120,a-10,this.color);h.x=n-h.width>>1,h.y=o-h.height>>1,i.addChild(h),this.proWidth=h.width;var l=s.getRoundRect(n-120,a-10,0,10,10);l.x=n-l.width>>1,l.y=o-l.height>>1,h.mask=l,this.progress=h;var d=new u;d.type=t.Const.SHAPE_CIRCLE,d.data={r:a/2,c:14781965},d.setBackground(16777215,5),this.addChild(d),d.x=r.x+r.width-a/2,d.y=r.y+a/2,this.txtLoadPos=new Point(d.x,d.y);var c=this.createText(0,0,"");c.size=40,c.textColor=11563776,this.txtLoad=c;var p=this.createText(0,0,"游戏加载");p.size=40,p.x=n-p.width>>1,p.y=r.y-2*p.height;var g=this.createText(0,0,"");g.size=40,this.txtName=g,this.updateName("敬请期待"),this.createAirFan(),this.airFan.x=d.x,this.airFan.y=d.y,this.createLogo(),this.update(0),this.play()},i.prototype.loop=function(t){return this.airFan.rotation+=3,!0},i.prototype.createAirFan=function(){this.airFan=new Sprite,this.addChild(this.airFan);for(var t=0;4>t;t++){var e=new Sprite;this.airFan.addChild(e),e.graphics.lineStyle(0),e.graphics.beginFill(16777215),e.graphics.cubicCurveTo(-29,-28,29,-28,0,0),e.graphics.endFill(),e.rotation=90*t}},i.prototype.createLogo=function(){var e=this.stageWidth,i=this.stageHeight,n=new u;n.type=t.Const.SHAPE_CIRCLE,n.data={r:50,c:14781965},n.setBackground(16777215,2),n.x=e>>1,n.y=n.height,this.addChild(n);var o=this.createText(0,0,"ZL");o.size=40,o.x=n.x-(o.width>>1),o.y=n.y-(o.height>>1)-15,o=this.createText(0,0,"game"),o.size=30,o.x=n.x-(o.width>>1),o.y=n.y-(o.height>>1)+15,this.addChild(t.MoonUI.getHeart(15,16777215)),o=this.createText(0,0,"子乐游戏"),o.size=40,o.textColor=14720801,o.x=e-o.width-10,o.y=i-o.height-10},i.prototype.createBgGradientFill=function(t,e){void 0===t&&(t=16635225),void 0===e&&(e=14720801);var i=this.stageWidth,n=this.stageHeight,o=new egret.Matrix;o.createGradientBox(2*i,2*n,Math.PI/2);var a=new Sprite;return a.graphics.beginGradientFill(egret.GradientType.RADIAL,[t,e],[1,1],[0,255],o),a.graphics.drawRect(0,0,i,n),this.addChild(a),a},i.prototype.updateName=function(t){this.txtName.text=t,this.txtName.x=this.stageWidth-this.txtName.width>>1,this.txtName.y=this.stageHeight/2+2*this.txtName.height},i.prototype.update=function(t){if(!(t>1)){t>.99&&this.stop(),this.progress.scaleX=t;var e=this.txtLoad,i=this.txtLoadPos;e.text=Math.ceil(100*t)+"%",e.x=this.stageWidth-e.width>>1,e.y=i.y-e.height/2;var n=s.getCircle(5+5*Math.random(),this.color,i.x,i.y);n.y=10-20*Math.random(),this.addChildAt(n,2),Tween.get(n).to({x:-this.proWidth,alpha:0},1e3)}},i}(t.GameView);t.GameLoad=O,__reflect(O.prototype,"moon.GameLoad")}(moon||(moon={}));var MOON_FTP=24,moon;!function(t){var e=function(e){function i(t){void 0===t&&(t="");var i=e.call(this)||this;return""!=t&&(i.skinName=t,i.position=new Point,i.addBitmap(),i.bgWidth=i.width,i.bgHeight=i.height),i}return __extends(i,e),i.prototype.addBitmap=function(){RES.hasRes(this.skinName)?(this.skinImage=new t.Scale9Image(this.skinName),this.skinImage.smoothing=!0,this.addChild(this.skinImage)):trace("找不到资源："+this.skinName)},i.prototype.setAnchorCenter=function(){this.anchorOffsetX=this.width>>1,this.anchorOffsetY=this.height>>1},i}(t.MoonContainer);t.Image=e,__reflect(e.prototype,"moon.Image");var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.items=[],e.index=0,e}return __extends(e,t),e.prototype.addItem=function(t){this.items.push(t)},e.prototype.removeItem=function(t){this.hasItem(t)&&this.items.splice(t,1)},e.prototype.getItem=function(t){return this.items[t]},e.prototype.hasItem=function(t){return this.items.length>0&&t>=0&&t<this.items.length},e.prototype.getNextItem=function(){return this.items[this.index++]},e.prototype.reset=function(){this.index=0},e}(e);t.BasicContainer=i,__reflect(i.prototype,"moon.BasicContainer");var n=function(e){function i(t,i){void 0===i&&(i=1);var n=e.call(this)||this;n.skinName=t;for(var o=0;i>o;o++)n.items.push(n.getBitmap());return n}return __extends(i,e),i.prototype.getBitmap=function(){var e;return RES.hasRes(this.skinName)?(e=new t.Scale9Image(this.skinName),this.addChild(e)):trace("找不到资源："+this.skinName),e},i.prototype.layout=function(e,i){void 0===i&&(i=0),e==t.Const.VERTICAL?t.SimpleLayout.displayRank(this.items,1,i,i,0,0):e==t.Const.HORIZONTAL&&t.SimpleLayout.displayRank(this.items,this.items.length,i,i,0,0)},i.prototype.setMultiLine=function(e,i){void 0===i&&(i=0),t.SimpleLayout.displayRank(this.items,e,i,i,0,0)},i}(i);t.ImageChartlet=n,__reflect(n.prototype,"moon.ImageChartlet",["moon.ILayout"]);var o=function(t){function e(e,i,n,o){void 0===e&&(e=""),void 0===o&&(o="png");var a=t.call(this)||this;a._ftp=MOON_FTP;for(var r=i;n>=r;r++)a.items.push(e+r+"_"+o);return a.skinName=a.getItem(0),a.addBitmap(),a.createTime(),a}return __extends(e,t),e.prototype.createTime=function(){null==this.timer&&(this.timer=new egret.Timer(1e3/this.ftp,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this))},e.prototype.onTimer=function(){this.hasItem(++this.index)?this.gotoAndStop(this.index):this.loop?(this.reset(),this.gotoAndStop(this.index)):this.timer.stop()},e.prototype.gotoAndStop=function(t){this.hasItem(t)?(this.index=t,this.skinName=this.getItem(t),this.update()):trace("gotoAndStop的参数请保持在0到"+this.items.length,"当前index="+t)},e.prototype.gotoAndPlay=function(t){this.index=t,this.play()},e.prototype.play=function(){this.timer.start()},e.prototype.stop=function(){this.timer.stop()},e.prototype.update=function(){RES.hasRes(this.skinName)?this.skinImage.texture=RES.getRes(this.skinName):trace("找不到资源："+this.skinName)},Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this.index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ftp",{get:function(){return this._ftp},set:function(t){this._ftp=t,this.removeTime(),this.createTime()},enumerable:!0,configurable:!0}),e.prototype.removeTime=function(){null!=this.timer&&(this.timer.stop(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this.timer=null)},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.removeTime()},e}(i);t.ImageAnimation=o,__reflect(o.prototype,"moon.ImageAnimation");var a=function(){function t(){}return t.getIns=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.setImage=function(t){this.image=t},t.prototype.setStageWH=function(t,e){this.tw=t,this.th=e},t.prototype.setTop=function(t){this.image.y=t},t.prototype.setBottom=function(t){this.image.y=this.th-this.image.height-t},t.prototype.setLeft=function(t){this.image.x=t},t.prototype.setRight=function(t){this.image.x=this.tw-this.image.width-t},t.prototype.setCenterX=function(t){void 0===t&&(t=0),this.image.x=(this.tw-this.image.width>>1)+t},t.prototype.setCenterY=function(t){void 0===t&&(t=0),this.image.y=(this.tw-this.image.width>>1)+t},t.prototype.setCenterXByPanent=function(t){t.parent instanceof e?t.x=t.parent.bgWidth-t.width>>1:t.x=t.parent.width-t.width>>1},t.prototype.setCenterYByPanent=function(t){t.parent instanceof e?t.y=t.parent.bgHeight-t.height>>1:t.y=t.parent.height-t.height>>1},t}();t.ImageLayout=a,__reflect(a.prototype,"moon.ImageLayout")}(moon||(moon={}));var AdverType;!function(t){var e=function(){function e(){}return e.shufferQuestion=function(t){for(var e=t.question.length-1;e>=0;e--){var i=Math.floor(Math.random()*e),n=t.question[e],o=t.question[i],a=t.num[e],r=t.num[i];Math.random()>=.5&&(t.question[i]=n,t.question[e]=o,t.num[i]=a,t.num[e]=r)}return t},e.mustSelect=function(t,e){for(var i=0;i<t.length;i++)if(e.num.slice(0,6).indexOf(t[i])<0)return!1;return!0},e.GetQuestionList=function(t){if(this.questionList=this.shufferQuestion(this.questionList),t.indexOf(-1)>=0)return this.questionList;for(;!this.mustSelect(t,this.questionList);)this.questionList=this.shufferQuestion(this.questionList);return this.questionList},e.selectPopUp=function(e){var i=[],n=[];for("popup"==e?n=t.adverName.popup_name.concat():"box"==e&&(n=t.adverName.box_name.concat());i.length<3;){var o=Math.floor(Math.random()*n.length);i=i.concat(n.splice(o,1))}return i},e.banner_name=["banner_alipay_jpg","banner_geli_jpg","banner_iphoneX_jpg","banner_kfc_jpg","banner_meituan_jpg","banner_nike_jpg","banner_ofo_jpg","banner_pinduoduo_jpg","banner_starbucks_jpg","banner_tebu_jpg","banner_vivo_jpg","banner_weiqian_jpg"],e.popup_name=["pop_alipay_jpg","pop_geli_jpg","pop_iphoneX_jpg","pop_kfc_jpg","pop_meituan_jpg","pop_nike_jpg","pop_ofo_jpg","pop_pinduoduo_jpg","pop_starbucks_jpg","pop_tebu_jpg","pop_vivo_jpg","pop_weiqian_jpg"],e.box_name=["alipay_jpg","geli_jpg","iphone_x_jpg","KFC_png","meituan_jpg","nike_png","ofo_jpg","pinduoduo_jpg","Starbucks_jpg","tebu_jpg","vivo_jpg","weiqian_jpg"],e.bg_name=["bg_alipay_png","bg_geli_png","bg_iphonex_png","bg_kfc_png","bg_meituan_png","bg_nike_png","bg_ofo_png","bg_pinduoduo_png","bg_starbucks_png","bg_tebu_png","bg_vivo_png","bg_weiqian_png"],e.video_name=["alipay.mp4","geli.mp4","iphoneX.mp4","kfc1.mp4","meituan.mp4","nike.mp4","ofo.mp4","pinduoduo.mp4","starbucks.mp4","tebu.mp4","vivo.mp4","weiqian.mp4"],e.questionList={answer:["A、否","B、是","C、不知道"],question:['"支付宝Alipay"的广告是否在本局游戏中出现：','"格力"的广告是否在本局游戏中出现：','"苹果iphone"的广告是否在本局游戏中出现：','"肯德基KFC"的广告是否在本局游戏中出现：','"美团meituan"的广告是否在本局游戏中出现：','"耐克Nike"的广告是否在本局游戏中出现：','"小黄车ofo"的广告是否在本局游戏中出现：','"拼多多"的广告是否在本局游戏中出现：','"星巴克Starbucks"的广告是否在本局游戏中出现：','"特步tebu"的广告是否在本局游戏中出现：','"Vivo"的广告是否在本局游戏中出现：','"味千拉面weiqian"的广告是否在本局游戏中出现：'],num:[0,1,2,3,4,5,6,7,8,9,10,11]},e}();t.adverName=e,__reflect(e.prototype,"AdverType.adverName");var i=function(t){function e(e){var i=t.call(this)||this;return i.stageH=egret.MainContext.instance.stage.stageHeight,i.stageW=egret.MainContext.instance.stage.stageWidth,i.createBackGroundImage(),i.createAdvertisement(e),i.createShutDown(),i}return __extends(e,t),e.prototype.createAdvertisement=function(t){this.advertisement||(this.advertisement=new egret.Bitmap),this.advertisement.texture=RES.getRes(t);var e=this.stageW/this.advertisement.width;this.advertisement.width=this.stageW,this.advertisement.height=e*this.advertisement.height,this.advertisement.y=this.stageH/2-this.advertisement.height/2,console.log("pop广告的width和height",this.advertisement.width),this.addChild(this.advertisement)},e.prototype.createBackGroundImage=function(){var t=new egret.Shape;t.graphics.clear(),t.graphics.beginFill(8421504,.6),t.graphics.drawRect(0,0,this.stageW,this.stageH),t.graphics.endFill(),this.addChild(t)},e.prototype.createShutDown=function(){this.shutdown_map=new egret.Bitmap,this.shutdown_map.texture=RES.getRes("shutdown_png"),this.shutdown_map.width=100,this.shutdown_map.height=100,this.shutdown_map.x=this.stageW-this.shutdown_map.width-20,this.shutdown_map.y=20,this.addChild(this.shutdown_map),this.shutdown_map.touchEnabled=!0,this.shutdown_map.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shutdown,this)},e.prototype.shutdown=function(){this.dispatchEventWith(e.GUNOPEN),this.removeChildren(),this.removeFromParent()},e.prototype.removeFromParent=function(){var t=this.parent;t&&t.contains(this)&&t.removeChild(this),t=null},e.GUNOPEN="gunopen",e}(egret.Sprite);t.Popup=i,__reflect(i.prototype,"AdverType.Popup");var n=function(e){function i(i){var n=e.call(this)||this;n.stageW=0,n.stageH=0,n.bg_all_name=t.adverName.bg_name.concat(),n.index=0,n.stageH=egret.MainContext.instance.stage.stageHeight,n.stageW=egret.MainContext.instance.stage.stageWidth,n.bg_name=n.selectBG();for(var o=0,a=n.bg_name;o<a.length;o++){var r=a[o];GameData.uploadMessage[GameData.uploadMessage.length-1].push(n.bg_all_name.indexOf(r)),console.log("push bg 广告出现",GameData.uploadMessage)}if(n.index=0,n.bg){var s=n;egret.Tween.get(n.bg).to({alpha:0},250).call(function(){s.bg.texture=RES.getRes(n.bg_name[n.index%3]),egret.Tween.get(n.bg).to({alpha:1},250)})}else n.bg=new egret.Bitmap,n.bg.texture=RES.getRes(n.bg_name[n.index%3]),n.bg.alpha=0,n.addChild(n.bg),egret.Tween.get(n.bg).to({alpha:1},250);return n.index++,n}return __extends(i,e),i.prototype.selectBG=function(){for(var e=[],i=t.adverName.bg_name.concat();e.length<3;){var n=Math.floor(Math.random()*i.length);e=e.concat(i.splice(n,1))}return e},i.prototype.updateBG=function(t){var e=this;if(t%3==0)if(this.bg){var i=this;egret.Tween.get(this.bg).to({alpha:0},250).call(function(){i.bg.texture=RES.getRes(e.bg_name[e.index%3]),egret.Tween.get(e.bg).to({alpha:1},250).call(function(){i.index++})})}else{this.bg=new egret.Bitmap,this.bg.texture=RES.getRes(this.bg_name[this.index%3]),this.bg.alpha=0,this.addChild(this.bg);var i=this;egret.Tween.get(this.bg).to({alpha:1},250).call(function(){i.index++})}return this.index},i}(egret.Sprite);t.bgAdver=n,__reflect(n.prototype,"AdverType.bgAdver");var o=function(e){function n(){var i=e.call(this)||this;i.intervalDuration=1e3,i.timeCount=15,i.index=0,i.advername=i.selectVideo(),i.stageHeight=egret.MainContext.instance.stage.stageHeight,i.stageWidth=egret.MainContext.instance.stage.stageWidth,i.index=0;for(var n=0,o=i.advername;n<o.length;n++){var a=o[n];GameData.uploadMessage[GameData.uploadMessage.length-1].push(t.adverName.video_name.indexOf(a)),console.log("push video 广告出现",i.advername,GameData.uploadMessage)}return i.addjili(),i}return __extends(n,e),n.prototype.selectVideo=function(){for(var e=[],i=t.adverName.video_name.concat();e.length<3;){var n=Math.floor(Math.random()*i.length);e=e.concat(i.splice(n,1))}return e},n.prototype.addjili=function(){this.awardAdver||(this.awardAdver=new egret.Bitmap),this.awardAdver.texture=RES.getRes("jili_png"),this.awardAdver.scaleX=.7,this.awardAdver.scaleY=.7,this.awardAdver.x=this.stageWidth-this.awardAdver.width/2-60,this.awardAdver.y=40;var t=new egret.Shape;t.graphics.beginFill(16729344,1),t.graphics.drawCircle(0,0,25),t.graphics.endFill(),t.x=this.awardAdver.x+this.awardAdver.width/2+35,t.y=this.awardAdver.y-7,this.awardLeftCount||(this.awardLeftCount=new egret.TextField),this.awardLeftCount.text=(3-this.index).toString(),this.awardLeftCount.textColor=0,this.awardLeftCount.size=30,this.awardLeftCount.bold=!0,this.awardLeftCount.x=t.x-10,this.awardLeftCount.y=t.y-10,this.addChild(this.awardAdver),this.addChild(t),this.addChild(this.awardLeftCount),this.awardAdver.touchEnabled=!0,this.awardAdver.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapjili,this)},n.prototype.tapjili=function(){this.index>=3?this.awardAdver.touchEnabled=!1:this.createAdvertisement()},n.prototype.pauser=function(){this.video&&(this.video.pause(),console.log("视频播放暂停"))},n.prototype.player=function(){this.video&&this.video.play()},n.prototype.createAdvertisement=function(){SoundControl.getIns().stop(MUSIC_BG),this.adver_sprit=new egret.Sprite,this.createBackGroundImage(),this.addChild(this.adver_sprit),this.video=new egret.Video,this.video.width=this.stageWidth,this.video.height=9*this.stageWidth/16,this.video.x=0,this.video.y=(this.stageHeight-this.video.height)/2,this.video.fullscreen=!1,this.video.poster="resource/assets/loading.jpg",this.video.load("resource/assets/Adver/video/"+this.advername[this.index%3]),this.adver_sprit.addChild(this.video),this.index++,GameData.adver_sum=this.index,this.awardLeftCount.text=(3-this.index).toString(),this.video.once(egret.Event.COMPLETE,this.onLoad,this),this.video.once(egret.IOErrorEvent.IO_ERROR,this.onLoadErr,this),this.createShutDown()},n.prototype.createBackGroundImage=function(){var t=new egret.Shape;t.graphics.clear(),t.graphics.beginFill(8421504,.9),t.graphics.drawRect(0,0,this.stageWidth,this.stageHeight),t.graphics.endFill(),this.adver_sprit.addChild(t)
},n.prototype.onLoad=function(t){this.createTimer(),this.video.play()},n.prototype.onLoadErr=function(t){console.log("video load error happened")},n.prototype.createTimer=function(){this.resertTimeout(),this.countDownTextField||(this.countDownTextField=new egret.TextField),this.countDownTextField.text=this.timeCount.toString(),this.countDownTextField.width=130,this.countDownTextField.height=60,this.countDownTextField.textAlign=egret.HorizontalAlign.CENTER,this.countDownTextField.textColor=65280,this.countDownTextField.bold=!0,this.countDownTextField.size=60,this.countDownTextField.y=30,this.countDownTextField.x=15,this.adver_sprit.addChild(this.countDownTextField)},n.prototype.SetIntervalExample=function(){this.intervalID_pro=egret.setTimeout(this.myRepeatingFunction,this,this.intervalDuration)},n.prototype.myRepeatingFunction=function(t){this.timeCount=this.timeCount-1,this.timeCount>=0?(this.countDownTextField.text=this.timeCount.toString(),this.intervalID_pro=egret.setTimeout(this.myRepeatingFunction,this,this.intervalDuration)):(egret.clearTimeout(this.intervalID_pro),this.video.pause())},n.prototype.pauseTimeout=function(){return egret.clearTimeout(this.intervalID_pro),this.timeCount},n.prototype.resertTimeout=function(){this.timeCount=15,this.SetIntervalExample()},n.prototype.createShutDown=function(){this.shutdown_map=new egret.Bitmap,this.shutdown_map.texture=RES.getRes("shutdown_png"),this.shutdown_map.width=100,this.shutdown_map.height=100,this.shutdown_map.x=this.stageWidth-this.shutdown_map.width-20,this.shutdown_map.y=20,this.adver_sprit.addChild(this.shutdown_map),this.shutdown_map.touchEnabled=!0,this.shutdown_map.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shutdown,this)},n.prototype.shutdown=function(){this.pauseTimeout()>0?(this.pauser(),this.createChoosePannel()):(this.removeFromParent(),this.dispatchEventWith(i.GUNOPEN))},n.prototype.removeFromParent=function(){SoundControl.getIns().play(MUSIC_BG,0,9999),this.dispatchEventWith(n.TAP_VIDEO),this.removeChild(this.adver_sprit)},n.prototype.createChoosePannel=function(){this.shutdown_choose||(this.shutdown_choose=new egret.Sprite),this.shutdown_choose.removeChildren(),this.shutdown_choose.width=this.stageWidth/2,this.shutdown_choose.height=this.stageHeight/6,this.shutdown_choose.x=(this.stageWidth-this.shutdown_choose.width)/2,this.shutdown_choose.y=2*this.stageHeight/5,this.getChildIndex(this.shutdown_choose)>=0||this.addChild(this.shutdown_choose);var t=new egret.Shape;t.graphics.clear(),t.graphics.beginFill(0,1),t.graphics.drawRect(0,0,this.shutdown_choose.width,this.shutdown_choose.height),t.graphics.endFill(),this.shutdown_choose.addChild(t);var e=new egret.TextField;e.text="尚未观看完毕，取消无法获得奖励",e.textColor=16711680,e.size=20,e.width=this.shutdown_choose.width,e.height=this.shutdown_choose.height/2,e.textAlign=egret.HorizontalAlign.CENTER,e.y=this.shutdown_choose.height/4-15,this.shutdown_choose.addChild(e);var i=new egret.Shape;i.graphics.lineStyle(1,16777215),i.graphics.moveTo(0,this.shutdown_choose.height/2),i.graphics.lineTo(e.width,this.shutdown_choose.height/2),this.shutdown_choose.addChild(i);var n=new egret.TextField;n.text="取消观看",n.textColor=11119017,n.size=30,n.width=this.shutdown_choose.width/2,n.height=this.shutdown_choose.height/2,n.textAlign=egret.HorizontalAlign.CENTER,n.y=this.shutdown_choose.height/2+30,n.x=0,this.shutdown_choose.addChild(n);var o=new egret.Shape;o.graphics.lineStyle(1,16777215),o.graphics.moveTo(e.width/2,this.shutdown_choose.height/2),o.graphics.lineTo(e.width/2,this.shutdown_choose.height),this.shutdown_choose.addChild(o);var a=new egret.TextField;a.text="继续观看",a.textColor=65280,a.size=30,a.width=this.shutdown_choose.width/2,a.height=this.shutdown_choose.height/2,a.textAlign=egret.HorizontalAlign.CENTER,a.y=this.shutdown_choose.height/2+30,a.x=this.shutdown_choose.width/2,this.shutdown_choose.addChild(a);var r=this;n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r.removeChild(r.shutdown_choose),r.getChildIndex(r.shutdown_map)>=0&&r.removeChild(r.shutdown_map),egret.clearTimeout(r.intervalID_pro),r.removeFromParent()},this),a.touchEnabled=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r.removeChild(r.shutdown_choose),r.SetIntervalExample(),r.player()},this)},n.TAP_VIDEO="tap_video",n}(egret.Sprite);t.AwardVideo=o,__reflect(o.prototype,"AdverType.AwardVideo");var a=function(e){function i(){var i=e.call(this)||this;i.stageW=0,i.stageH=0,i.intervalDuration=1e3,i.timeCount=15,i.banner_all_name=t.adverName.banner_name.concat(),i.index=0,i.boxSquenceType=0,i.stageH=egret.MainContext.instance.stage.stageHeight,i.stageW=egret.MainContext.instance.stage.stageWidth,i.banner_name=i.selectBanner();for(var n=0,o=i.banner_name;n<o.length;n++){var a=o[n];GameData.uploadMessage[GameData.uploadMessage.length-1].push(i.banner_all_name.indexOf(a)),console.log("push banner 广告出现",i.banner_name,GameData.uploadMessage)}return i.banner=[],i.circle=[],i.createCicle(),i.createBanner(),i.createTimer(),i}return __extends(i,e),i.prototype.selectBanner=function(){for(var e=[],i=t.adverName.banner_name.concat();e.length<3;){var n=Math.floor(Math.random()*i.length);e=e.concat(i.splice(n,1))}return e},i.prototype.stopBanner=function(){egret.clearInterval(this.intervalID),console.log("清楚了倒计时")},i.prototype.createBanner=function(){for(var t=0,e=0,i=this.banner_name;e<i.length;e++){var n=i[e],o=new egret.Bitmap;o.texture=RES.getRes(n),o.width=this.stageW,o.height=this.stageH/7,o.x=t*this.stageW,t++,this.banner.push(o),this.addChild(o)}this.circlePoll()},i.prototype.createCicle=function(){this.circle=[];for(var t=0;t<this.banner.length;t++){var e=new egret.Shape;this.index%3==t?e.graphics.beginFill(14423100,1):e.graphics.beginFill(14474460,1),e.graphics.drawCircle(0,0,10),e.x=this.stageW/2+30*(t-1),e.y=this.stageH/8-30,e.graphics.endFill(),this.circle.push(e)}},i.prototype.createPoll=function(){this.removeChildren();for(var t=0,e=this.banner;t<e.length;t++){var i=e[t];i.x=Math.floor(i.x/this.stageW)*this.stageW,i.x<0&&(i.x=(this.banner.length-1)*this.stageW),this.addChild(i)}for(var n=0,o=this.banner;n<o.length;n++){var i=o[n];egret.Tween.get(i).to({x:i.x-this.stageW,y:i.y},499)}this.circlePoll()},i.prototype.circlePoll=function(){this.createCicle();for(var t=0,e=this.circle;t<e.length;t++){var i=e[t];this.addChildAt(i,20)}this.index=this.index+1,GameData.adver_sum=this.index},i.prototype.createTimer=function(){this.intervalID=egret.setInterval(this.myRepeatingFunction,this,this.intervalDuration)},i.prototype.myRepeatingFunction=function(t){console.log("倒计时"),this.timeCount>=0?this.timeCount=this.timeCount-1:(this.timeCount=15,this.createPoll())},i}(egret.Sprite);t.bannerAdver=a,__reflect(a.prototype,"AdverType.bannerAdver")}(AdverType||(AdverType={}));var MButton=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(moon.BasicButton);__reflect(MButton.prototype,"MButton");var MImage=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(moon.Image);__reflect(MImage.prototype,"MImage");var ImageAnimation=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(moon.ImageAnimation);__reflect(ImageAnimation.prototype,"ImageAnimation");var Layout=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(moon.ImageLayout);__reflect(Layout.prototype,"Layout");var Scale9Image=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(moon.Scale9Image);__reflect(Scale9Image.prototype,"Scale9Image");var MoonEvent=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(moon.MoonEvent);__reflect(MoonEvent.prototype,"MoonEvent");var GameData=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(moon.GameData);__reflect(GameData.prototype,"GameData");var Const=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(moon.Const);__reflect(Const.prototype,"Const");var moon;!function(t){var e=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return __extends(r,e),r.prototype.render=function(){e.prototype.render.call(this),this.initView()},r.prototype.initView=function(){this.createBgGradientFill(),this.panelGame=new i,this.panelGame.addEvent(t.MoonEvent.OVER,this.onOver,this),this.addChild(this.panelGame),this.setBtn=new h,this.setBtn.x=100,this.setBtn.y=100,this.setBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openSetPanel,this),this.addChild(this.setBtn),this.panelSet=new a,this.panelSet.addEvent(t.MoonEvent.PLAY,this.onSetHandler,this),this.panelSet.addEvent(t.MoonEvent.CHANGE,this.onSetHandler,this),this.panelStart=new n,this.panelStart.addEvent(t.MoonEvent.START,this.start,this),this.addChild(this.panelStart),this.panelOver=new o,this.panelOver.addEvent(t.MoonEvent.START,this.start,this)},r.prototype.start=function(t){this.panelGame.initGame(),this.panelGame.start()},r.prototype.onOver=function(t){this.addChild(this.panelOver),this.panelOver.alpha=0,Tween.get(this.panelOver).to({alpha:1},300),this.panelOver.update(t.data)},r.prototype.openSetPanel=function(t){this.addChild(this.panelSet),this.panelSet.alpha=0,Tween.get(this.panelSet).to({alpha:1},300),this.panelGame.pause()},r.prototype.onSetHandler=function(e){if(e.type==t.MoonEvent.PLAY)this.panelGame.start();else{e.data;"soundBg"==e.dataType||"soundEffect"==e.dataType}},r}(t.GameView);t.BasicGameMain=e,__reflect(e.prototype,"moon.BasicGameMain");var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.render=function(){e.prototype.render.call(this),this.initView()},i.prototype.initView=function(){this.createBgGradientFill(),this.txtScore=this.createText(),this.txtLevel=this.createText(200),this.txtBlood=this.createText(400),this.initGame()},i.prototype.initGame=function(){this.level=1,this.score=0,this.blood=200,this.updateBlood(),this.updateLevel(),this.updateScore()},i.prototype.start=function(){this.play()},i.prototype.pause=function(){this.stop()},i.prototype.loop=function(t){return this.blood--,this.score+=10,this.updateScore(),this.updateBlood(),!0},i.prototype.over=function(){this.dispEvent(t.MoonEvent.OVER,{score:this.score,level:this.level}),this.stop()},i.prototype.updateLevel=function(){this.txtLevel.text="level:"+this.level},i.prototype.updateScore=function(){this.txtScore.text="score:"+this.score,this.score>0&&this.score%200==0&&(this.level++,this.updateLevel())},i.prototype.updateBlood=function(){this.txtBlood.text="blood:"+this.blood,0==this.blood&&this.over()},i.prototype.createImageBg=function(t){this.addChild(new MImage(t))},i.prototype.dispose=function(){this.stop(),e.prototype.dispose.call(this)},i}(t.GameView);t.BasicGamePanel=i,__reflect(i.prototype,"moon.BasicGamePanel");var n=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.render=function(){e.prototype.render.call(this),this.initView()},i.prototype.initView=function(){var t=this.createBackground();t.alpha=.5,this.createBtn("开始游戏"),this.createTitle("游戏标题")},i.prototype.createBtn=function(t){var e=this.createButton(t);return e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),e.x=this.stageWidth-e.width>>1,e.y=this.stageHeight-e.height>>1,e},i.prototype.createTitle=function(t){var e=this.createText(0,0,t);return e.x=(this.stageWidth-e.width)/2,e.y=(this.stageHeight-e.height)/2-100,e},i.prototype.onClick=function(e){this.dispEvent(t.MoonEvent.START),Tween.get(this).to({alpha:0},300).call(this.backCall,this)},i.prototype.backCall=function(t){this.removeFromParent()},i.prototype.createImageBg=function(t){this.addChild(new MImage(t))},i}(t.GameView);t.BasicGameStart=n,__reflect(n.prototype,"moon.BasicGameStart");var o=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.initView=function(){var t=this.createBackground();t.alpha=.5,this.btnRestart=this.createBtn("再来一次"),this.btnRank=this.createBtn("排行榜"),this.btnRank.y+=100,this.txtScore=this.createText(),this.txtLevel=this.createText(),this.rankPanel=new r},i.prototype.update=function(e){this.txtScore.text="score:"+e.score,this.txtLevel.text="level:"+e.level,this.txtScore.x=(this.stageWidth-this.txtScore.width)/2,this.txtLevel.x=(this.stageWidth-this.txtLevel.width)/2,this.txtScore.y=(this.stageHeight-this.txtScore.height)/2-60,this.txtLevel.y=this.txtScore.y-60,t.GameData.score=e.score},i.prototype.onClick=function(i){var n=i.currentTarget;n==this.btnRestart?e.prototype.onClick.call(this,i):n==this.btnRank&&this.rankPanel&&t.GameData.stage.addChild(this.rankPanel)},i}(n);t.BasicGameOver=o,__reflect(o.prototype,"moon.BasicGameOver");var a=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.render=function(){e.prototype.render.call(this),this.initView()},i.prototype.initView=function(){var e=this.createBackground(0,.5);this.addChild(e);var i=new t.MoonDisplayObject,n=this.stageWidth>>1,o=16750848;i.type=t.Const.SHAPE_RECT_ROUND,i.data={w:1.1*n,h:n,ew:100,eh:100,c:o},i.setBackground(16777215,5),i.x=e.width-n>>1,i.y=e.height-n>>1,this.addChild(i);var a=new t.Label("背景音乐",16777215),r=new t.Label("游戏音效",16777215);a.textField.size=40,r.textField.size=40,a.x=r.x=50,a.y=50,r.y=150,i.addChild(a),i.addChild(r);var s=this.getToggleSwitch();s.x=a.x+a.width+10,s.y=a.y-5,i.addChild(s),this.btnSoundBg=s;var s=this.getToggleSwitch();s.x=r.x+r.width+10,s.y=r.y-5,i.addChild(s),this.btnSoundEffect=s;var h=new MButton;h.label="关  闭",h.x=i.width-h.width>>1,h.y=240,h.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),i.addChild(h),this.btnClose=h},i.prototype.getToggleSwitch=function(){var e=t.Skin.switchOn,i=t.Skin.switchOn,n=t.MoonUI.getSwitch(t.Color.bule,t.Color.white),o=t.MoonUI.getSwitch(t.Color.red,t.Color.white),a=new t.MoreSkinButton([e,i,n,o]);return a.toggleSwitch=!0,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),a},i.prototype.onClick=function(e){var n,o=e.currentTarget;o==this.btnSoundBg?(n=this.btnSoundBg.currentPage,alertAuto("背景音乐"+(1==n?"开":"关"),1),l.localWrite(i.SOUND_BG,n.toString()),this.dispEvent(t.MoonEvent.CHANGE,this.btnSoundBg.currentPage,"soundBg")):o==this.btnSoundEffect?(n=this.btnSoundEffect.currentPage,alertAuto("游戏音效"+(1==n?"开":"关"),1),l.localWrite(i.SOUND_EFFECT,n.toString()),this.dispEvent(t.MoonEvent.CHANGE,this.btnSoundEffect.currentPage,"soundEffect")):o==this.btnClose&&(this.removeFromParent(),this.dispEvent(t.MoonEvent.PLAY))},i.prototype.setValue=function(){var t=l.localRead(i.SOUND_BG)||"1";this.btnSoundBg.updatePage(parseInt(t));var t=l.localRead(i.SOUND_EFFECT)||"1";this.btnSoundEffect.updatePage(parseInt(t))},i.SOUND_BG="sound bg",i.SOUND_EFFECT="sound effect",i}(t.BasicView);t.BasicGameSet=a,__reflect(a.prototype,"moon.BasicGameSet");var r=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.items=[],t.max=50,t}return __extends(i,e),i.prototype.render=function(){e.prototype.render.call(this),this.initView()},i.prototype.initView=function(){this.createBackground(0,.5);var e=t.MoonUI.getRect(this.stageWidth-100,this.stageHeight-200,0);e.alpha=.8,this.addChild(e),Layout.getIns().setCenterXByPanent(e),Layout.getIns().setCenterYByPanent(e);var i=new Rectangle(e.x,e.y,e.width,e.height),n=60,o=new Sprite;o.graphics.lineStyle(2,16777215),o.graphics.moveTo(i.x,i.y+n),o.graphics.lineTo(i.x,i.y),o.graphics.lineTo(i.right,i.y),o.graphics.lineTo(i.right,i.bottom),o.graphics.lineTo(i.x,i.bottom),o.graphics.lineTo(i.x,i.y+n),o.graphics.lineTo(i.right,i.y+n),this.addChild(o);var a=30,r=t.MoonUI.getCircle(a,16777215),h=t.MoonUI.getX(a>>1,a>>1,65280,4);h.anchorOffsetX=h.anchorOffsetY=a>>2,r.addChild(h);var l=new MButton(r,r);l.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.addChild(l),l.x=e.x+e.width,l.y=e.y;var d=this.createText(0,0,"分数排行榜");Layout.getIns().setCenterXByPanent(d),d.y=e.y+(n-d.height)/2,this.addChild(d);var d=this.createText(e.x,e.y-n/2);this.addChild(d),this.txtRank=d,this.txtRank.text="你的排名:",this.conatiner=new Sprite,this.addChild(this.conatiner);for(var c=e.width-2,u=0;u<this.max;u++){var p=new s(c,u);this.conatiner.addChild(p),this.items.push(p)}t.SimpleLayout.displayRank(this.items,1);var g=new t.ScrollBar;g.target=this.conatiner,g.setSize(i.width,i.height-n-2),g.layout(t.Const.VERTICAL),this.addChild(g),g.x=i.x+1,g.y=i.y+n+2},i.prototype.onClick=function(t){this.removeFromParent()},i.prototype.update=function(e){for(var i=this.max,n=-1,o=0;i>o;o++)if(o<=this.max){var a=100,r=this.items[o];if(r.txtScore.text=""+a,i-1>o){var s=90;t.GameData.score>s&&t.GameData.score<=a&&(n=o)}}n>0?this.txtRank.text="你的排名:"+n:this.txtRank.text="未上榜"},i}(t.BasicView);t.BasicGameRank=r,__reflect(r.prototype,"moon.BasicGameRank");var s=function(t){function e(e,i){var n=t.call(this)||this;return n.colors=[0,14516795,13805662,14668132],n.w=e,n.rank=i+1,n.initView(),n}return __extends(e,t),e.prototype.initView=function(){var t=this.createRect(this.w,80,0);t.alpha=this.rank%2==0?.6:.1,this.addChild(t),this.txtRank=this.createText(150,0),this.txtScore=this.createText(350,0),this.rank<=3&&(this.txtRank.textColor=this.txtScore.textColor=this.colors[this.rank]),this.txtRank.text=String(this.rank),this.txtScore.text=String(0),Layout.getIns().setCenterYByPanent(this.txtRank),Layout.getIns().setCenterYByPanent(this.txtScore)},e}(t.BasicView);t.RankItem=s,__reflect(s.prototype,"moon.RankItem");var h=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype.render=function(){e.prototype.render.call(this);var t=this.getSkin(),i=this.getSkin(16733440);this.statusNormal=t,this.statusDown=i,this.updateSkin(this.statusNormal)},i.prototype.getSkin=function(e){void 0===e&&(e=16750848);var i=e,n=6963200,o=new Sprite,a=90,r=new t.MoonDisplayObject;r.type=t.Const.SHAPE_RECT_ROUND,r.data={w:a,h:a,ew:30,eh:30,c:i},r.anchorOffsetX=r.anchorOffsetY=a>>1,o.addChild(r),o.addChild(t.MoonUI.getCircle(30,n));for(var s=8,h=360/s,l=0;s>l;l++){var d=t.MoonUI.getRect(15,80,n);d.anchorOffsetX=d.width>>1,d.anchorOffsetY=d.height>>1,d.rotation=h*l,o.addChild(d)}return o.addChild(t.MoonUI.getCircle(20,i)),o.addChild(t.MoonUI.getCircle(6,n)),o.anchorOffsetX=o.anchorOffsetY=-(a/2+4),o},i}(MButton);t.SetButton=h,__reflect(h.prototype,"moon.SetButton");var l=function(){function e(){}return e.getGameIdKey=function(e){return t.GameData.gameId+e},e.localWrite=function(t,e){egret.localStorage.setItem(this.getGameIdKey(t),e)},e.localRead=function(t){return egret.localStorage.getItem(this.getGameIdKey(t))},e.localRemove=function(t){egret.localStorage.removeItem(this.getGameIdKey(t))},e.localClear=function(){egret.localStorage.clear()},e.serverWrite=function(){},e.serverRead=function(){return""},e.serverRemove=function(){},e}();t.BasicGameStorage=l,__reflect(l.prototype,"moon.BasicGameStorage");var d=function(){function e(){}return e.init=function(e){egret.Capabilities.isMobile?e.scaleMode=egret.StageScaleMode.FIXED_WIDTH:e.scaleMode=egret.StageScaleMode.SHOW_ALL,t.GameData.stage=e,t.TipsManager.getIns().init(e),t.LogManager.getIns().init(e),t.AlertManager.getIns().init(e)},e}();t.GameMoon=d,__reflect(d.prototype,"moon.GameMoon");var c=function(){function t(){}return t.getTimeFormatByNum=function(t,e,i){void 0===e&&(e=":"),void 0===i&&(i=3);var n,o,a;return 1==i?a=this.numberFormat(t):2==i?(o=this.numberFormat(t/60),a=this.numberFormat(t%60),o+e+a):(n=this.numberFormat(t/60/60>>0),o=this.numberFormat(t/60%60),a=this.numberFormat(t%60),n+e+o+e+a)},t.numberFormat=function(t){return t=Math.floor(t),t>=10?""+t:"0"+t},t.twoDistance=function(t,e){var i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},t}();t.GameUtils=c,__reflect(c.prototype,"moon.GameUtils")}(moon||(moon={}));var control;!function(t){var e=function(){function t(t){this.stage=t}return t.prototype.open=function(){this.close(),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouch,this)},t.prototype.close=function(){this.stage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouch,this)},t.prototype.onTouch=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this.posStart=new egret.Point(t.stageX,t.stageY),this.controlStart();break;case egret.TouchEvent.TOUCH_MOVE:this.posMove=new egret.Point(t.stageX,t.stageY),this.controlMove();break;case egret.TouchEvent.TOUCH_END:this.posEnd=new egret.Point(t.stageX,t.stageY),this.controlEnd()}},t.prototype.controlStart=function(){null!=this.startBackFun&&this.startBackFun(this.posStart),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouch,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this)},t.prototype.controlMove=function(){null!=this.moveBackFun&&this.moveBackFun(this.posMove)},t.prototype.controlEnd=function(){null!=this.endBackFun&&this.endBackFun(this.posEnd),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouch,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this)},t}();t.ControlBasic=e,__reflect(e.prototype,"control.ControlBasic");var i=function(t){function e(e,i,n){var o=t.call(this,e)||this;return o.controlBar=i,o.controlBg=n,o}return __extends(e,t),e.prototype.controlStart=function(){this.controlBar.hitTestPoint(this.posStart.x,this.posStart.y)&&(t.prototype.controlStart.call(this),this.isDrag=!0)},e.prototype.controlMove=function(){if(0!=this.isDrag){var t=this.posMove.x,e=this.posMove.y,i=this.controlBg,n=this.controlBar,o=i.x,a=i.y,r=t-o,s=e-a,h=Math.sqrt(r*r+s*s),l=i.width>>1,d=r/h,c=s/h;if(l>h?(n.x=t,n.y=e):(n.x=o+d*l,n.y=a+c*l),null!=this.moveBackFun){var u=new egret.Point(n.x-i.x,n.y-i.y);this.moveBackFun(u)}}},e.prototype.controlEnd=function(){this.isDrag=!1,this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouch,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this);var t=this.controlBg,e=this.controlBar;e.x=t.x,e.y=t.y,null!=this.endBackFun&&this.endBackFun(this.posEnd)},e}(e);t.ControlBarMove=i,__reflect(i.prototype,"control.ControlBarMove");var n=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.controlEnd=function(){this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouch,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this);var t=this.posEnd.x-this.posStart.x,e=this.posEnd.y-this.posStart.y,i=new egret.Point(0,0);Math.abs(t)>Math.abs(e)?i.x=t>0?1:-1:i.y=e>0?1:-1,null!=this.endBackFun&&this.endBackFun(this.posEnd),null!=this.moveEndBackFun&&this.moveEndBackFun(i)},e}(e);t.ControlFingerMove=n,__reflect(n.prototype,"control.ControlFingerMove");var o=function(t){function e(e,i){var n=t.call(this,e)||this;return n.display=i,n.distance=new egret.Point,n}return __extends(e,t),Object.defineProperty(e.prototype,"target",{set:function(t){this.display=t},enumerable:!0,configurable:!0}),e.prototype.controlStart=function(){this.display.hitTestPoint(this.posStart.x,this.posStart.y)&&(t.prototype.controlStart.call(this),this.isDrag=!0,this.distance.x=this.posStart.x-this.display.x,this.distance.y=this.posStart.y-this.display.y)},e.prototype.controlMove=function(){this.isDrag&&(t.prototype.controlMove.call(this),this.display.x=this.posMove.x-this.distance.x,this.display.y=this.posMove.y-this.distance.y)},e.prototype.controlEnd=function(){this.isDrag=!1,t.prototype.controlEnd.call(this),null!=this.endBackFun&&this.endBackFun()},e}(e);t.ControlDrag=o,__reflect(o.prototype,"control.ControlDrag");var a=function(t){function e(e,i){var n=t.call(this,e)||this;n.nodes=[];for(var o=0;o<i.length;o++){var a=i[o],s=new r(a.display,a.backCall);n.nodes.push(s)}return n}return __extends(e,t),e.prototype.onTouch=function(e){this.id=e.touchPointID,t.prototype.onTouch.call(this,e)},e.prototype.check=function(t,e,i){for(var n=this.nodes,o=0;o<n.length;o++){var a=n[o];1==i?a.display.hitTestPoint(t,e)&&(a.id=this.id,a.backCall(i)):a.id==this.id&&(a.id=-1,a.backCall(i))}},e.prototype.controlStart=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this.check(this.posStart.x,this.posStart.y,1)},e.prototype.controlEnd=function(){t.prototype.controlEnd.call(this),this.check(this.posEnd.x,this.posEnd.y,0)},e}(e);t.ControlMoreTab=a,__reflect(a.prototype,"control.ControlMoreTab");var r=function(){function t(t,e){this.display=t,this.backCall=e}return t}();t.MorePointNode=r,__reflect(r.prototype,"control.MorePointNode");var s=function(){function t(){}return t.randomSequence=function(){var e=GameData.gameType;return e=t.shuffter(e)},t.shuffter=function(t){for(var e=t.length-1;e>=0;e--){var i=Math.floor(Math.random()*e),n=t[e],o=t[i];Math.random()>=.5&&(t[i]=n,t[e]=o)}return t},t}();t.SequenceRandom=s,__reflect(s.prototype,"control.SequenceRandom")}(control||(control={}));var Popup=AdverType.Popup,AwardVideo=AdverType.AwardVideo,MUSIC_CLICK_BTN="click_mp3",MUSIC_HIT="hit_mp3",MUSIC_ADDNUM="addNum_mp3",MUSIC_FIRE="fire_mp3",MUSIC_FLOOR="floor_mp3",MUSIC_BG="background_mp3",EVENT_FIRE="event fire",EVENT_REMOVE="event remove",TYPE_HAND="type hand",ICON_ADD="addIcon_png",SHAPE={rect:"rect",circle:"circle"},OVER_DIS=200,GameFrame=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.render=function(){},e.prototype.initView=function(){this.width=this.stageHeight,this.height=this.stageWidth,this.addChild(new MImage("bg_jpg"))},e}(moon.BasicGamePanel);__reflect(GameFrame.prototype,"GameFrame");var GameControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.names=[],e.removeSkins=[],e.moveNum=0,e.ballNum=0,e.minBodyCount=1,e.adver_names=[],e.pop_adver_type=!1,e.box_adver_type=!1,e.bg_adver_type=!1,e.popup_flag=!1,e.popup_hit=!1,e.pop_index=0,e.pop_adver_name=[],e}return __extends(e,t),e.prototype.render=function(){t.prototype.render.call(this),this.mainframe=new GameFrame,this.mainframe.width=this.stageWidth,this.mainframe.height=this.stageHeight,this.mainframe.touchEnabled=!0,GameData.stageHeight=this.stageHeight,GameData.stageWidth=this.stageWidth,SoundControl.getIns().addItem(MUSIC_HIT),SoundControl.getIns().addItem(MUSIC_ADDNUM),SoundControl.getIns().addItem(MUSIC_FIRE),SoundControl.getIns().addItem(MUSIC_FLOOR),SoundControl.getIns().addItem(MUSIC_BG,!0);var e=new P2World(0,200),i=e.createWall(new egret.Rectangle(0,0,GameData.stageWidth,GameData.stageHeight));this.addChild(this.mainframe),this.mainframe.addChild(new MImage("bg_jpg")),this.mainframe.addChild(e),this.world=e,this.world.touchEnabled=!0,e.loopBackFun=this.loopP2World.bind(this);for(var n=0;n<i.length;n++){var o=i[n];o.userData.floor=!0,this.setAndBallHit(o)}this.material=new p2.Material;for(var n=1;3>=n;n++){var a="rect"+n+"_png",r="circle"+n+"_png";this.names.push(a,r,a,r)}this.names.push(ICON_ADD);var s=this.createBody("left_png"),h=this.createBody("right_png");s.userData.pipe=!0,h.userData.pipe=!0;var l=s.userData.skin.height/2,d=this.setBottom(l,100);s.position=[25,d],h.position=[this.getRight(25),d];var c=this.createBody("topLine_png");c.position=[GameData.stageWidth>>1,0];var u=new Gun;u.addEvent(EVENT_FIRE,this.onFire,this),this.mainframe.addChild(u),this.gun=u,u.x=this.getCenterX(0),u.y=100,this.createBottom(),this.container=new Sprite,this.mainframe.addChild(this.container);var p=moon.MoonUI.getRect(GameData.stageWidth,GameData.stageHeight-200,0,0,160);this.container.mask=p;var g=new control.ControlBasic(this.mainframe);g.startBackFun=this.startBackFun.bind(this),g.moveBackFun=this.controlMove.bind(this),g.endBackFun=this.endBackFun.bind(this),this.controlGun=g,e.p2World.on("beginContact",this.onHitBegin.bind(this)),this.txtScore=this.createText(50,50),this.txtLevel=this.createText(200,200),this.txtBlood=this.createText(50,100)},e.prototype.testZero=function(){for(var t=0;6>t;t++){var e=this.createBody("rect1_png");e.userData.num=!0;var i=e.userData.skin;i.initNum(100),e.angle=45,e.position=[100+100*t,500]}var n=this.createBall();n.mass=100,n.position=[240,400]},e.prototype.initView=function(){},e.prototype.initGame=function(){var t=this;this.score=0,this.level=0,this.ballNum=0,this.moveNum=0,this.blood=GameData.BLOOD,this.gun.restart(),this.updateScore(),this.updateBlood(),this.controlGun.open(),this.popup_flag=!1,this.popup_hit=!1,this.adver_names=[],this.bg_adver_type=!1,this.pop_adver_type=!1,this.box_adver_type=!1,this.pop_index=0,this.pop_adver_name=[],SoundControl.getIns().play(MUSIC_BG,0,9999),GameData.uploadMessage.push([]),GameData.adver_sum=0,GameData.video_tap=[-1,-1,-1],GameData.uploadMessage[GameData.uploadMessage.length-1].push(GameData.gameType[GameData.gameIndex]),0==GameData.gameType[GameData.gameIndex]&&(console.log("无广告"),GameData.uploadMessage[GameData.uploadMessage.length-1].push(-1),GameData.uploadMessage[GameData.uploadMessage.length-1].push(-1),GameData.uploadMessage[GameData.uploadMessage.length-1].push(-1));var e=moon.GAMETYPE.gameSceneSetting[GameData.gameType[GameData.gameIndex]];if(console.log(e),e.banner&&(this.banner_adver=new AdverType.bannerAdver,this.banner_adver.y=this.stageHeight-this.banner_adver.height,this.addChild(this.banner_adver)),e.popUp){this.pop_adver_type=!0,this.adver_names=["ads_type_png"],this.pop_adver_name=AdverType.adverName.selectPopUp("popup");for(var i=0,n=this.pop_adver_name;i<n.length;i++){var o=n[i];GameData.uploadMessage[GameData.uploadMessage.length-1].push(AdverType.adverName.popup_name.indexOf(o)),console.log(AdverType.adverName.popup_name.indexOf(o)),console.log("push popup 广告出现",this.pop_adver_name,GameData.uploadMessage)}}if(e.backgroud&&(this.bg_adver_type=!0,this.bg=new AdverType.bgAdver(this.blood),this.mainframe.addChild(this.bg),this.mainframe.setChildIndex(this.bg,1),this.bg.x=this.stageWidth/2-this.bg.width/2,this.bg.y=this.stageHeight/5),e.award){this.video_adver=new AdverType.AwardVideo;var a=this;this.video_adver.addEventListener(Popup.GUNOPEN,function(){a.bloodAdd(2)},this),this.video_adver.addEventListener(AwardVideo.TAP_VIDEO,function(){GameData.video_tap[GameData.adver_sum-1]=t.blood},this),this.video_adver.touchEnabled=!0,this.addChild(this.video_adver),this.setChildIndex(this.video_adver,100)}if(e.specialBox){this.box_adver_type=!0,this.adver_names=AdverType.adverName.selectPopUp("box");for(var r=0,s=this.adver_names;r<s.length;r++){var o=s[r];GameData.uploadMessage[GameData.uploadMessage.length-1].push(AdverType.adverName.box_name.indexOf(o)),console.log("push box 广告出现",this.adver_names,GameData.uploadMessage)}}GameData.questionList=AdverType.adverName.GetQuestionList(GameData.uploadMessage[GameData.uploadMessage.length-1].slice(1,4)),GameData.uploadMessage[GameData.uploadMessage.length-1]=GameData.uploadMessage[GameData.uploadMessage.length-1].concat(GameData.questionList.num.slice(0,6)),console.log("问题顺序之后的SceneManager：",GameData.uploadMessage)},e.prototype.bloodAdd=function(t){var e=new egret.Bitmap;e.texture=RES.getRes("fire_png");var i=e.width,n=e.height;e.width=2*this.stageWidth/3,e.height=n*e.width/i,e.x=this.stageWidth/2,e.y=this.stageHeight/5,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.scaleX=.3,e.scaleY=.3,this.addChild(e);var o=new egret.TextField;o.text="发射次数 + "+t.toString()+" ",o.textColor=16711680,o.size=40,o.bold=!0,o.width=this.stageWidth,o.textAlign=egret.HorizontalAlign.CENTER,o.y=e.y-o.height/2,this.addChild(o),SoundControl.getIns().play(MUSIC_ADDNUM);var a=this;egret.Tween.get(e).to({scaleX:1.3,scaleY:1.3},500).call(function(){a.removeChild(e),egret.Tween.get(o).to({alpha:.2},500).call(function(){a.removeChild(o),a.blood=a.blood+t,a.txtBlood.text="发射次数:"+a.blood.toString()})})},e.prototype.revive=function(){this.moveNum=0,this.ballNum=0,this.play(),this.controlGun.open()},e.prototype.setBottom=function(t,e){return GameData.stageHeight-t-e},e.prototype.moveNumBody=function(){for(var t=this,e=this.world.p2World.bodies,i=e.length,n=0;i>n;n++){var o=e[n];
if(o.userData&&o.userData.skin&&o.userData.num&&(o.position[1]-=10,o.position[1]<=OVER_DIS&&o.userData.skin.imageName!=ICON_ADD))return void this.over()}if(this.moveNum<7)this.moveNum++,setTimeout(this.moveNumBody.bind(this),50);else{if(this.moveNum=0,this.controlGun.open(),this.popup_hit){this.popup_hit=!1,this.popup_flag=!1,this.controlGun.close();var a=new AdverType.Popup(this.pop_adver_name[this.pop_index++%3]);this.addChild(a);var r=this;a.addEventListener(Popup.GUNOPEN,function(){r.controlGun.open(),r.bloodAdd(1),GameData.adver_sum++,0==t.blood&&t.over()},this)}else 0==this.blood&&this.over();this.bg_adver_type&&(GameData.adver_sum=this.bg.updateBG(this.blood))}},e.prototype.over=function(){t.prototype.over.call(this),SoundControl.getIns().stop(MUSIC_BG),this.controlGun.close(),this.bg&&this.mainframe.getChildIndex(this.bg)>=0&&this.mainframe.removeChild(this.bg),this.banner_adver&&this.contains(this.banner_adver)&&(this.banner_adver.stopBanner(),this.removeChild(this.banner_adver),this.banner_adver=null),this.video_adver&&this.contains(this.video_adver)&&this.removeChild(this.video_adver);for(var e=this.world.p2World.bodies,i=0;i<e.length;i++){var n=e[i];if(n.userData&&n.userData.skin&&n.userData.num){var o=n.userData.skin;this.world.removeBodys.push(n),o.removeFromParent(!0)}}},e.prototype.updateNumBody=function(){for(var t=0,e=0;5>e;e++)if(Math.random()<.7){t++;var i=5,n=100,o=this.createNumBody(),a=120+Math.floor(e%i)*n,r=1e3+Math.floor(e/i)*n;o.position=[a,r],o.angle=-Math.random()*Math.PI/4+Math.random()*Math.PI/4,o.userData.num=!0;var s=o.userData.skin,h=Math.ceil(Math.random()*(this.level+5));h=h+this.minBodyCount+this.level,s.initNum(h),this.container.addChild(s)}console.log("numbody的随机个数="+t),0==t?this.updateNumBody():this.moveNumBody()},e.prototype.onHitImpact=function(t){var e;if(t.bodyA.userData&&t.bodyB.userData&&(t.bodyA.userData.ball&&(e=t.bodyA),t.bodyB.userData.ball&&(e=t.bodyB),t.bodyA.userData.ball&&t.bodyB.userData.num||t.bodyB.userData.ball&&t.bodyA.userData.num)){var i=new Point(e.velocity[0],e.velocity[1]),n=Math.sqrt(i.x*i.x+i.y*i.y);console.log(n),50>n&&this.setBallImpulse(e)}},e.prototype.onHitBegin=function(t){var e;if(t.bodyA.userData.ball&&(e=t.bodyA),t.bodyB.userData.ball&&(e=t.bodyB),e&&0==e.mass&&(e.userData.setImpulse=!0,e.mass=200),t.bodyA.userData.ball&&t.bodyB.userData.pipe||t.bodyB.userData.ball&&t.bodyA.userData.pipe)e.userData.setImpulse&&(e.applyImpulse([2*this.vec.x,0],[0,0]),e.userData.setImpulse=!1);else{e&&e.userData.setImpulse&&(e.applyImpulse([1.5*this.vec.x,this.vec.y],[0,0]),e.userData.setImpulse=!1);var i;if(t.bodyA.userData.num&&(i=t.bodyA),t.bodyB.userData.num&&(i=t.bodyB),i){this.score++,this.updateScore();var n=i.userData.skin;if(Tween.get(n).to({y:n.y+2},100).to({y:n.y-2},100),n.update(),0==n.value)n.imageName==ICON_ADD?(this.gun.bulletMax++,this.ballNum++,this.createNewBall(e)):"ads_type_png"==n.imageName&&(this.popup_hit=!0),this.world.removeBodys.push(i),n.removeFromParent(!0);else{var o=new Point(e.velocity[0],e.velocity[1]),a=Math.sqrt(o.x*o.x+o.y*o.y);console.log(a),200>a&&this.setBallImpulse(e)}}}(t.bodyA.userData.ball&&t.bodyB.userData.floor||t.bodyB.userData.ball&&t.bodyA.userData.floor)&&(this.removeSkins.push(e.userData.skin),this.world.removeBodys.push(e))},e.prototype.setBallImpulse=function(t){var e=Math.random()>.5?-5e3:5e3,i=-5e3-2e3*Math.random();t.applyImpulse([e,i],[0,0])},e.prototype.updateScore=function(){this.txtScore.text="分数:"+this.score,this.score%50==0&&this.level++},e.prototype.updateBlood=function(){this.txtBlood.text="发射次数:"+this.blood},e.prototype.startBackFun=function(t){this.gun.showLine(),this.controlGun.close(),this.controlMove(t)},e.prototype.controlMove=function(t){var e=new egret.Point(t.x-this.gun.x,t.y-this.gun.y);this.gun.updatePos(e)},e.prototype.endBackFun=function(t){var e=new egret.Point(t.x-this.gun.x,t.y-this.gun.y),i=Math.atan2(e.x,e.y),n=1e4,o=Math.ceil(Math.sin(i)*n),a=Math.ceil(Math.cos(i)*n);this.vec=new egret.Point(o,a),this.ballNum=this.gun.bulletMax,this.gun.hideLine(),this.gun.fire(),this.blood--,this.updateBlood()},e.prototype.onFire=function(t){var e=this.createBall();e.position=[this.gun.x,this.gun.y],this.doMaterial(e),e.applyImpulse([2*this.vec.x,2*this.vec.y],[0,0]),this.mainframe.setChildIndex(this.gun,this.numChildren-1)},e.prototype.createNewBall=function(t){var e=this.createBall();e.position=[t.position[0],t.position[1]],e.mass=100,this.setBallImpulse(e)},e.prototype.getRight=function(t){return GameData.stageWidth-t},e.prototype.getBottom=function(t){return GameData.stageHeight-t},e.prototype.getCenterX=function(t){return GameData.stageWidth-t>>1},e.prototype.doMaterial=function(t){for(var e=this.world,i=e.p2World.bodies,n=i.length,o=0;n>o;o++){var a=i[o];a.userData.hit&&this.setMaterial(t,a)}},e.prototype.setMaterial=function(t,e){var i=this.material;t.shapes[0].material=i,e.shapes[0].material=i;var n=new p2.ContactMaterial(i,i,{restitution:.7,friction:0});this.world.p2World.addContactMaterial(n)},e.prototype.createBottom=function(){var t=this.world,e=59,i=520,n=t.createConvexBodyShape([[0,e],[i/2,0],[i,e]]);n.position=[this.getCenterX(0),this.getBottom(e/2)+10],n.type=p2.Body.KINEMATIC,this.setAndBallHit(n);var o=this.createSkin("bottom_png");o.x=this.getCenterX(0)-5,o.y=this.getBottom(e/2),this.mainframe.addChild(o)},e.prototype.setAndBallHit=function(t){var e=t.shapes[0];e.collisionMask=6},e.prototype.createBall=function(){var t=this.world,e=this.createSkin("ball_png"),i=t.createCircleBodyShape(e.width>>1);i.userData.skin=e,i.userData.ball=!0,i.mass=0;var n=i.shapes[0];return n.collisionGroup=2,i},e.prototype.createBody=function(t,e,i){void 0===e&&(e=SHAPE.rect),void 0===i&&(i=p2.Body.KINEMATIC);var n,o=this.world,a=this.createSkin(t);return e==SHAPE.rect?n=o.createBoxBodyShape(a.width,a.height,i):e==SHAPE.circle&&(n=o.createCircleBodyShape(a.width>>1,i)),n.userData.skin=a,n.userData.hit=!0,this.setAndBallHit(n),n},e.prototype.createNumBody=function(){var t=this.names,e="";this.box_adver_type&&Math.random()<=.4?(e=this.adver_names[GameData.adver_sum%3],GameData.adver_sum++):e=t[Math.floor(Math.random()*t.length)],this.gun.bulletMax<5?Math.random()<.4&&(this.adver_names.indexOf(e)>=0&&GameData.adver_sum--,e=ICON_ADD):this.gun.bulletMax>=10&&e==ICON_ADD&&(e="circle1_png"),!this.popup_flag&&this.pop_adver_type&&Math.floor(this.blood/6+1)==3-this.pop_index&&(this.popup_flag=!0,e="ads_type_png");var i=2==e.split("rect").length?SHAPE.rect:SHAPE.circle;this.adver_names.indexOf(e)>=0&&(i=SHAPE.rect);var n=this.createBody(e,i);return n},e.prototype.createSkin=function(t){var e=new NumImage(t);return e.x=-500,e.setAnchorCenter(),this.mainframe.addChild(e),e},e.prototype.loopP2World=function(){for(var t=this.world.p2World.bodies,e=t.length,i=0;e>i;i++){var n=t[i];if(n.userData&&n.userData.skin&&n.userData.ball){var o=new Point(n.velocity[0],n.velocity[1]),a=Math.sqrt(o.x*o.x+o.y*o.y);1>a&&(console.log(a),this.setBallImpulse(n))}}},e.prototype.loop=function(t){for(var e=this.removeSkins,i=0;i<e.length;i++){var n=e[i];n.y-=20,n.x>GameData.stageWidth/2?n.x=GameData.stageWidth-n.width:n.x=n.width,n.parent&&n.y<0&&(this.ballNum--,n.removeFromParent(!0))}return 0==this.ballNum&&this.nextLevel(),!0},e.prototype.nextLevel=function(){this.ballNum=this.gun.bulletMax,this.removeSkins.length=0,this.updateNumBody(),this.gun.initNum()},e}(moon.BasicGamePanel);__reflect(GameControl.prototype,"GameControl");var NumImage=function(t){function e(e){void 0===e&&(e="");var i=t.call(this,e)||this;return i._value=-1,i}return __extends(e,t),e.prototype.initNum=function(t){this.txt=this.createText(0,0),this.skinName==ICON_ADD||"ads_type_png"==this.skinName?this._value=1:AdverType.adverName.box_name.indexOf(this.skinName)>=0?this._value=1:this.value=t},e.prototype.createText=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i="");var n=(new moon.Label).textField;return n.x=t,n.y=e,n.text=i,this.addChild(n),n},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t,this.txt.text=String(t),this.txt.textColor=0,null!=this.parent&&(Layout.getIns().setCenterXByPanent(this.txt),Layout.getIns().setCenterYByPanent(this.txt))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageName",{get:function(){return this.skinName},enumerable:!0,configurable:!0}),e.prototype.update=function(){this._value--,this.value=this._value,this.imageName==ICON_ADD||"ads_type_png"==this.imageName||AdverType.adverName.box_name.indexOf(this.imageName)>=0?SoundControl.getIns().play(MUSIC_ADDNUM):SoundControl.getIns().play(MUSIC_HIT)},e}(MImage);__reflect(NumImage.prototype,"NumImage");var Gun=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bulletMax=1,e}return __extends(e,t),e.prototype.render=function(){var t=new MImage("gun_png");t.anchorOffsetX=t.width>>1,this.addChild(t),this.gun=t;var e=new MImage("numBg_png");e.setAnchorCenter(),this.addChild(e);var i=new MImage("line_png");i.anchorOffsetX=i.width>>1,this.line=i,this.txtNum=this.createText(0,0,""),this.bullet=this.bulletMax,this.updateNum(this.bullet)},e.prototype.restart=function(){this.bulletMax=1,this.initNum()},e.prototype.updatePos=function(t){var e=180*-Math.atan2(t.x,t.y)/Math.PI;this.gun.rotation=e,this.line.rotation=e},e.prototype.initNum=function(){this.bullet=this.bulletMax,this.updateNum(this.bullet)},e.prototype.showLine=function(){this.addChildAt(this.line,0)},e.prototype.hideLine=function(){this.line.removeFromParent()},e.prototype.updateNum=function(t){this.txtNum.text=String(t),this.txtNum.anchorOffsetX=this.txtNum.width>>1,this.txtNum.anchorOffsetY=this.txtNum.height>>1},e.prototype.fire=function(){this.bullet>0&&(this.updateNum(--this.bullet),Tween.get(this.gun).to({scaleY:.6},100).to({scaleY:1},100),this.dispEvent(EVENT_FIRE),setTimeout(this.fire.bind(this),200),SoundControl.getIns().play(MUSIC_FIRE))},e}(moon.BasicView);__reflect(Gun.prototype,"Gun");var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){moon.GameMoon.init(this.stage),moon.GameData.version=moon.Const.VER_RELEASE,egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return t=i.sent(),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return e=i.sent(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 2:return i.sent(),this.stage.removeChild(t),[3,4];case 3:return e=i.sent(),console.error(e),[3,4];case 4:return[2]}})})},e.prototype.createGameScene=function(){this.addChild(GameMain.getInstance())},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var P2World=function(t){function e(e,i){void 0===e&&(e=0),void 0===i&&(i=0);var n=t.call(this)||this;return n.colors=[10],n.removeBodys=[],n.world=new p2.World({gravity:[e,i]}),n.colors[p2.Body.DYNAMIC]=16711680,n.colors[p2.Body.KINEMATIC]=65280,n.colors[p2.Body.STATIC]=255,n.addEventListener(egret.Event.ENTER_FRAME,n.updateWorld,n),n.txtWarn=new egret.TextField,n}return __extends(e,t),Object.defineProperty(e.prototype,"p2World",{get:function(){return this.world},enumerable:!0,configurable:!0}),e.prototype.getBody=function(t,e){void 0===t&&(t=0),void 0===e&&(e=p2.Body.DYNAMIC);var i=new p2.Body({mass:t});return i.type=e,i.userData={},i},e.prototype.createWall=function(t){var e=[];return e.push(this.createPlane(0,0,0)),e.push(this.createPlane(-Math.PI/2,0,0)),e.push(this.createPlane(Math.PI,0,t.height)),e.push(this.createPlane(Math.PI/2,t.width,0)),e},e.prototype.createPlane=function(t,e,i){void 0===t&&(t=Math.PI);var n=new p2.Plane,o=this.getBody(0,p2.Body.STATIC);return o.addShape(n),o.angle=t,o.position[0]=e,o.position[1]=i,this.world.addBody(o),o},e.prototype.createCircleBodyShape=function(t,e){void 0===e&&(e=p2.Body.DYNAMIC);var i=this.getBody(10,e),n=new p2.Circle({radius:t});return i.addShape(n),this.world.addBody(i),i},e.prototype.createBoxBodyShape=function(t,e,i,n){void 0===i&&(i=p2.Body.DYNAMIC),void 0===n&&(n=0);var o=this.getBody(10,i),a=new p2.Box({width:t,height:e});return o.addShape(a),o.angle=n,this.world.addBody(o),o},e.prototype.createConvexBodyShape=function(t,e){void 0===e&&(e=p2.Body.DYNAMIC);var i=this.getBody(10,e);return i.fromPolygon(t,{optimalDecomp:!1}),this.world.addBody(i),i},e.prototype.createPolygon=function(t,e,i){void 0===t&&(t=3),void 0===e&&(e=30),void 0===i&&(i=p2.Body.DYNAMIC);for(var n=(this.getBody(10,i),[]),o=0;t>o;o++){var a=Math.cos(o*(360/t)*Math.PI/180)*e,r=Math.sin(o*(360/t)*Math.PI/180)*e;n.push([a,r])}return this.createConvexBodyShape(n,i)},e.prototype.createBoxCircleBodyShape=function(t,e,i){void 0===i&&(i=p2.Body.DYNAMIC);var n=this.getBody(10,i);n.fixedRotation=!0,t/=2,e/=1.5;var o=new p2.Box({width:t,height:e}),a=new p2.Circle({radius:t/2});return n.addShape(o),n.addShape(a),o.position[1]=-e,a.position[1]=-t/2,this.world.addBody(n),n},e.prototype.drawSkin=function(t){var e=new egret.Sprite,i=this.colors[t.type];e.graphics.lineStyle(1,i,1),e.graphics.beginFill(i,.5);for(var n=0;n<t.shapes.length;n++){var o=t.shapes[n],a=new egret.Point(o.position[0],o.position[1]);if(o instanceof p2.Box){var r=o.width,s=o.height,h=r/2,l=s/2;e.graphics.moveTo(a.x,a.y),e.graphics.lineTo(a.x-h,a.y-l),e.graphics.drawRect(a.x-h,a.y-l,r,s),e.graphics.endFill()}else if(o instanceof p2.Convex){var d=o.vertices,c=d.length,u=d[0];e.graphics.moveTo(0,0),e.graphics.lineTo(u[0],u[1]);for(var p=0;c>p;p++)u=d[p],0==p?e.graphics.moveTo(u[0],u[1]):e.graphics.lineTo(u[0],u[1]);var u=d[0];e.graphics.lineTo(u[0],u[1]),e.graphics.endFill()}else if(o instanceof p2.Circle){var g=o.radius;e.graphics.moveTo(a.x,a.y),e.graphics.lineTo(a.x,g+a.y),e.graphics.drawCircle(a.x,a.y,g),e.graphics.endFill()}}return e.x=t.position[0],e.y=t.position[1],t.userData.skin=e,this.addChild(e),e},e.prototype.updateWorld=function(t){var e=1/60,i=this.removeBodys;this.world.step(e);for(var n=this.world.bodies,o=n.length,a=0;o>a;a++){var r=n[a];if(r.userData&&r.userData.skin){var s=r.userData.skin;s.x=r.position[0],s.y=r.position[1],s.rotation=180*r.angle/Math.PI}else!(r.shapes[0]instanceof p2.Plane)}for(a=0;a<i.length;a++)r=i[a],r.userData&&r.userData.skin&&(s=r.userData.skin,null!=s.parent,r.userData=null),this.world.removeBody(r);null!=this.loopBackFun&&this.loopBackFun()},e}(egret.DisplayObjectContainer);__reflect(P2World.prototype,"P2World");var SoundControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sounds={},e.channels={},e.volumeBg=1,e.volumeEffect=1,e.isNoVolume=1,e}return __extends(e,t),e.getIns=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.checkSoundIsBg=function(t,e){return t[e+"-bg"]},e.prototype.addItem=function(t,e){void 0===e&&(e=!1);var i=t;if(e&&(i=t+"-bg"),!this.sounds[i]){var n=RES.getRes(t);this.sounds[i]=n}},e.prototype.play=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=1);var n=this.volumeEffect;if(this.checkSoundIsBg(this.sounds,t)&&(t+="-bg",n=this.volumeBg),this.sounds[t]){var o=this.sounds[t];this.channels[t]=o.play(e,i),0==this.isNoVolume?this.channels[t].volume=0:this.channels[t].volume=n}},e.prototype.stop=function(t){if(this.checkSoundIsBg(this.channels,t)&&(t+="-bg"),this.channels[t]){var e=this.channels[t];e.stop()}},e.prototype.setVolume=function(t,e){if(this.checkSoundIsBg(this.channels,t)&&(t+="-bg"),this.channels[t]){var i=this.channels[t];i.volume=e}},e.prototype.setBgVolume=function(t){for(var e in this.channels)if(2==e.split("-bg").length){var i=this.channels[e];this.volumeBg=t,0!=i.position&&(i.volume=t)}},e.prototype.setEffectVolume=function(t){for(var e in this.channels)if(1==e.split("-bg").length){var i=this.channels[e];this.volumeEffect=t,0!=i.position&&(i.volume=t)}},e.prototype.setIsNoVolume=function(t){this.isNoVolume=t;for(var e in this.channels){var i=this.channels[e];0!=i.position&&(0==t?i.volume=0:this.checkSoundIsBg(this.sounds,e)?i.volume=this.volumeBg:i.volume=this.volumeEffect)}},e}(egret.HashObject);__reflect(SoundControl.prototype,"SoundControl");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.progress=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.submitScore=function(t,e,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getRank=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.canPlayAd=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.playAd=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.addToStage,e),e}return __extends(e,t),e.prototype.addToStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addToStage,this)},e.prototype.onProgress=function(t,e){platform.progress(t/e)},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var CONST_SCORE_HIGHEST="playBall score highest",GamePanel={rank:null,over:null,game:null},GameMain=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.initView=function(){this.panelWelcome=new Welcome,this.addChild(this.panelWelcome),this.panelGame=new GameControl,this.panelGame.addEvent(MoonEvent.OVER,this.onOver,this),GamePanel.game=this.panelGame,this.panelSet=new GameSet,this.panelSet.addEvent(MoonEvent.PLAY,this.onSetHandler,this),this.panelSet.addEvent(MoonEvent.CHANGE,this.onSetHandler,this),this.panelStart=new GameStart,this.panelStart.addEvent(moon.MoonEvent.START,this.start,this),this.panelQues=new QuesScreen,this.panelOver=new GameOver,this.panelOver.addEvent(moon.MoonEvent.START,this.start,this),this.setBtn=new moon.SetButton,this.setBtn.x=100,this.setBtn.y=100,this.setBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.openSetPanel,this),this.Adver_Init(),GameData.scoreHighest=Number(moon.BasicGameStorage.localRead(CONST_SCORE_HIGHEST))},e.prototype.Adver_Init=function(){GameData.gameType=control.SequenceRandom.randomSequence(),GameData.gameType=control.SequenceRandom.randomSequence(),GameData.uploadMessage=[],GameData.gameIndex=0,GameData.gameType=[2].concat(GameData.gameType),console.log("游戏类型序列是：",GameData.gameType),this.getRankList()},e.prototype.getRankList=function(){var t=new egret.HttpRequest;t.withCredentials=!0,t.responseType=egret.HttpResponseType.TEXT,t.open("//icontinua.com/ftf/minigame/getRankList2",egret.HttpMethod.GET),t.setRequestHeader("content-type","application/x-www-form-urlencoded"),t.send(),t.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),t.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},e.prototype.onGetComplete=function(t){var e=t.currentTarget;console.log("get data : ",JSON.parse(e.response).data),GameData.RankList=JSON.parse(e.response).data},e.prototype.onGetIOError=function(t){console.log(t),this.responseLabel||(this.responseLabel=new egret.TextField),this.responseLabel.size=18,this.responseLabel.text=t.data.toString()+"...",this.addChild(this.responseLabel),this.responseLabel.x=50,this.responseLabel.y=70},e.prototype.onGetProgress=function(t){console.log("get progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%"),this.responseLabel||(this.responseLabel=new egret.TextField),this.responseLabel.size=18,this.responseLabel.text=Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%",this.addChild(this.responseLabel),this.responseLabel.x=50,this.responseLabel.y=70},e.prototype.AddPanel=function(t){this.removeChildren(),this.addChild(this[t]),"panelGame"==t&&(this.panelStart=new GameStart,this.panelStart.addEvent(moon.MoonEvent.START,this.start,this),this.addChild(this.panelStart))},e}(moon.BasicGameMain);__reflect(GameMain.prototype,"GameMain");var Welcome=function(t){function e(){var e=t.call(this)||this;return console.log("执行"),e.stageH=egret.MainContext.instance.stage.stageHeight,e.stageW=egret.MainContext.instance.stage.stageWidth,e.createBackGroundImage(),e.createWelcome(),e.beginButton(),e}return __extends(e,t),e.prototype.createWelcome=function(){var t=new egret.TextField;t.text="Welcome",t.width=this.stageW-20,t.textColor=0,t.bold=!0,t.x=10,t.size=40,t.textAlign=egret.HorizontalAlign.CENTER,t.y=40;var e=new egret.TextField;e.text="本次实验旨在",e.width=this.stageW-20,e.textColor=0,e.size=25,e.bold=!1,e.x=10,e.textAlign=egret.HorizontalAlign.CENTER,e.y=t.y+70;var i=new egret.TextField;i.text="探讨在小游戏中投放不同形式的广告给用户带来的影响",i.width=this.stageW-20,i.textColor=0,i.size=30,i.bold=!1,i.x=10,i.textAlign=egret.HorizontalAlign.CENTER,i.y=e.y+60;var n=new egret.TextField;n.text="tip",n.textColor=9142604,n.width=this.stageW/2,n.size=30,n.x=this.stageW/2,n.bold=!1,n.y=e.y+this.stageH/7,n.textAlign=egret.HorizontalAlign.LEFT;var o=new egret.Shape;o.graphics.lineStyle(4,9142604),o.graphics.beginFill(8388352,1),o.graphics.drawCircle(this.stageW/2-15,n.y+n.height/2,11),o.graphics.endFill(),this.addChild(o);var a=new egret.TextField;a.text="1、请您关闭手机，保持实验过程的专注；\n",a.width=this.stageW,a.textColor=0,a.size=20,a.bold=!1,a.x=this.stageW/10,a.y=n.y+60;var r=new egret.TextField;r.text="2、刚开始，您会试玩一局；\n",r.width=this.stageW,r.textColor=0,r.size=20,r.bold=!1,r.x=this.stageW/10,r.y=a.y+60;var s=new egret.TextField;s.text="3、整个实验过程大概耗时30-40分钟。\n",s.width=this.stageW,s.textColor=0,s.size=20,s.bold=!1,s.x=this.stageW/10,s.y=r.y+60,this.addChild(t),this.addChild(e),this.addChild(i),this.addChild(n),this.addChild(o),this.addChild(a),this.addChild(r),this.addChild(s),this.createInput()},e.prototype.createBackGroundImage=function(){var t=new egret.Shape;t.graphics.clear(),t.graphics.beginFill(14474460),t.graphics.drawRect(0,0,this.stageW,this.stageH),t.graphics.endFill(),this.addChild(t)},e.prototype.createInput=function(){var t=new eui.Image,e=new eui.EditableText;t.source="resource/assets/checkbox_unselect.png",t.scale9Grid=new egret.Rectangle(1.5,1.5,20,20),t.width=500,t.height=60,t.x=(this.stageW-t.width)/2,t.y=this.stageH/2+120;var i=new egret.TextField;i.text="请输入您的名字：",i.x=t.x,i.y=t.y-60,i.textColor=0,this.addChild(i),this.addChild(t),e.text="",e.textColor=2241484,e.width=t.width,e.height=t.height,e.left=40,e.x=t.x,e.y=t.y,this.addChild(e),e.wordWrap=!0,e.addEventListener(egret.Event.CHANGE,this.onChang,this)},e.prototype.onChang=function(t){egret.log(t.target.text),this.usr_name=t.target.text},e.prototype.beginButton=function(){var t=new egret.Bitmap;t.texture=RES.getRes("button_png"),t.width=t.width/2,t.height=t.height/2,t.x=this.stageW/2-t.width/2,t.y=this.stageH-t.height-200;var e=new egret.TextField;e.text="我已阅读，开始",e.width=t.width,e.x=t.x,e.size=25,e.y=t.y+(t.height/2-e.height/2)-5,e.textAlign=egret.HorizontalAlign.CENTER,e.textColor=0,this.addChild(t),this.addChild(e),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.beginButtonTap,this)},e.prototype.beginButtonTap=function(t){this.usr_name||(this.usr_name="unknown"+Math.floor(100*Math.random()).toString()),GameData.uploadUser.names=this.usr_name,this.removeChildren(),this.createTimeScreen()},e.prototype.createTimeScreen=function(){this.createBackGroundImage();var t=new TransferScreen("第 1/3 部分 - 预实验","试玩一局","panelGame");GameData.preGame=!0,this.addChild(t)},e}(egret.Sprite);__reflect(Welcome.prototype,"Welcome");var TransferScreen=function(t){function e(e,i,n){var o=t.call(this)||this;return o.intervalDuration=1e3,o.timeCount=5,o.radius=11,o.stageH=egret.MainContext.instance.stage.stageHeight,o.stageW=egret.MainContext.instance.stage.stageWidth,o.createBackground(),o.jumpScreen=n,o.createMainFrame(i),o.createTimer(),o}return __extends(e,t),e.prototype.createBackground=function(){var t=new egret.Shape;t.graphics.clear(),t.graphics.beginFill(14474460),t.graphics.drawRect(0,0,this.stageW,this.stageH),t.graphics.endFill(),t.touchEnabled=!0,this.addChild(t)},e.prototype.createMainFrame=function(t){var e=new egret.TextField;e.text="接下来,您将...",e.width=this.stageW,e.textColor=0,e.size=20,e.textAlign=egret.HorizontalAlign.CENTER,e.bold=!1,e.y=this.stageH/4;var i=t,n=new egret.TextField;if(n.text=i,n.width=this.stageW,n.textColor=0,n.size=30,n.textAlign=egret.HorizontalAlign.CENTER,n.bold=!1,n.y=e.y+60,this.addChild(e),this.addChild(n),"开始 2 组正式实验"==t){var i="每组 6 局",o=new egret.TextField;o.text=i,o.width=this.stageW,o.textColor=0,o.size=25,o.textAlign=egret.HorizontalAlign.CENTER,o.bold=!1,o.y=n.y+60,this.addChild(o)}},e.prototype.createTimer=function(){this.SetIntervalExample();var t=new egret.TextField;t.text="开始倒计时",t.size=15,t.textAlign=egret.HorizontalAlign.CENTER,t.y=this.stageH/2-80,t.width=this.stageW,t.textColor=0,this.addChild(t);var e=new egret.Shape;e.graphics.lineStyle(4,9142604),e.graphics.beginFill(14474460,1),e.graphics.drawCircle(this.stageW/2,this.stageH/2,40),e.graphics.endFill(),this.addChild(e),this.countDownTextField||(this.countDownTextField=new egret.TextField),this.countDownTextField.text=this.timeCount.toString(),this.countDownTextField.width=this.stageW,this.countDownTextField.textAlign=egret.HorizontalAlign.CENTER,this.countDownTextField.textColor=0,this.countDownTextField.bold=!0,this.countDownTextField.size=40,this.countDownTextField.y=this.stageH/2-20,this.addChild(this.countDownTextField)},e.prototype.SetIntervalExample=function(){this.intervalID=egret.setTimeout(this.myRepeatingFunction,this,this.intervalDuration)},e.prototype.beginButton=function(){var t=new egret.Bitmap;t.texture=RES.getRes("button_png"),t.width=t.width/2,t.height=t.height/2,t.x=this.stageW/2-t.width/2,t.y=this.stageH-t.height-100;var e=new egret.TextField;e.text="开始",e.width=t.width,e.x=t.x,e.size=25,e.y=t.y+(t.height/2-e.height/2)-5,e.textAlign=egret.HorizontalAlign.CENTER,e.textColor=0,this.addChild(t),this.addChild(e),t.touchEnabled=!0;var i=this;t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i.dispatchEventWith(moon.MoonEvent.START),i.removeChildren(),i.removeFromParent(),GameMain.getInstance().AddPanel(i.jumpScreen)},this)},e.prototype.removeFromParent=function(t){void 0===t&&(t=!1);var e=this.parent;e&&e.contains(this)&&e.removeChild(this),e=null},e.prototype.myRepeatingFunction=function(t){this.timeCount=this.timeCount-1,this.timeCount>=0?(this.countDownTextField.text=this.timeCount.toString(),this.intervalID=egret.setTimeout(this.myRepeatingFunction,this,this.intervalDuration)):(egret.clearInterval(this.intervalID),console.log("清楚了计时"),this.beginButton())},e}(egret.Sprite);__reflect(TransferScreen.prototype,"TransferScreen");var GameStart=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initView=function(){this.createImageBg("startPanel_png");var t=new MButton(new MImage("btnStart_png"),new MImage("btnStart_png"));this.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),t.x=this.stageWidth-t.width>>1,t.y=650},e}(moon.BasicGameStart);__reflect(GameStart.prototype,"GameStart");var GameOver=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.layout=Layout.getIns(),e}return __extends(e,t),e.prototype.initView=function(){this.layout.setStageWH(this.stageWidth,this.stageHeight),this.createBackground(8421504,.9),this.txtDescribe=this.createText(0,50),this.txtScore=this.createText(0,110),this.txtScore.size=50,this.txtDescribe.size=30,this.btnRestart=this.createMButton("buttonnext_png",0,0),this.btnRestart.width=this.btnRestart.width/2,this.btnRestart.x=this.stageWidth/2-this.btnRestart.width,this.btnRestart.y=this.stageHeight-this.btnRestart.height-120;var t=this.createText(0,this.btnRestart.y);t.text="下一步",t.height=this.btnRestart.height,t.width=this.stageWidth,t.size=25,t.textAlign=egret.HorizontalAlign.CENTER,t.textColor=0,t.verticalAlign=egret.VerticalAlign.MIDDLE,this.addChild(Rank.getInstance())},e.prototype.createMButton=function(t,e,i){var n=this.createSkinBtn(t,t);return n.x=e,n.y=i,n},e.prototype.createSkinBtn=function(t,e){var i=new Scale9Image(t),n=new Scale9Image(e);n.alpha=.5;var o=new MButton(i,n);return o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.addChild(o),o},e.prototype.onClick=function(t){if(t.currentTarget==this.btnRestart){console.log("下一步进入问题页面"),GameData.gameIndex++,console.log("game index:",GameData.gameIndex);var e=new Questionaire,i=this;e.addEventListener(moon.MoonEvent.START,function(){GameData.preGame&&(GameData.preGame=!1,GameData.uploadUser.fullscore=0,GameData.uploadUser.maxscore=0,GameData.scoreHighest=0);var t=new TransferScreen("第 2/3 部分 - 正式实验","开始 第 "+GameData.gameIndex+" 局 正式实验","panelGame");i.addChild(t);var e=i;t.addEventListener(moon.MoonEvent.START,function(){Tween.get(e).to({alpha:0},300).call(e.removeFromParent,e)},i)},this),this.addChild(e)}},e.prototype.update=function(t){GameData.score=t.score,GameData.score>GameData.scoreHighest&&(GameData.scoreHighest=GameData.score),this.txtDescribe.textFlow=[{text:"=  ",style:{textColor:12632256}},{text:"本局得分",style:{fontFamily:"微软雅黑",textColor:16777215}},{text:"  =",style:{textColor:12632256}}],this.txtScore.text=String(GameData.score),this.txtDescribe.x=this.stageWidth/2-this.txtDescribe.width/2,this.txtScore.x=this.stageWidth/2-this.txtScore.width/2,GameData.uploadMessage[GameData.uploadMessage.length-1].push(GameData.score),GameData.uploadMessage[GameData.uploadMessage.length-1].push(GameData.adver_sum),console.log("点击视频的blood:",GameData.video_tap),GameData.uploadMessage[GameData.uploadMessage.length-1]=GameData.uploadMessage[GameData.uploadMessage.length-1].concat(GameData.video_tap),GameData.uploadUser.fullscore+=GameData.score,GameData.uploadUser.maxscore=GameData.scoreHighest,console.log("adver_sum:::::",GameData.adver_sum),Rank.getInstance().RankList()},e}(moon.BasicGameOver);__reflect(GameOver.prototype,"GameOver");var Questionaire=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.question_index=0,e.couldGoon=!1,e}return __extends(e,t),e.prototype.render=function(){t.prototype.render.call(this),this.initView()},e.prototype.initView=function(){this.question_index=0,this.couldGoon=!1,this.createBackground(14474460,1),this.questionLayer||(this.questionLayer=new egret.Sprite),this.addChild(this.questionLayer),this.updateQuestion(),this.createButtonImage()},e.prototype.createButtonImage=function(){var t=new egret.Bitmap;t.texture=RES.getRes("button_png"),t.width=t.width/2,t.height=t.height/2,t.x=this.stageWidth/2-t.width/2,t.y=this.stageHeight-t.height-120;var e=new egret.TextField;e.text="下一步",e.width=t.width,e.x=t.x,e.size=25,e.y=t.y+(t.height/2-e.height/2)-5,e.textAlign=egret.HorizontalAlign.CENTER,e.textColor=0,this.addChild(t),this.addChild(e),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.beginButtonTap,this)
},e.prototype.updateQuestion=function(){if(this.questionLayer.removeChildren(),GameData.preGame)switch(this.question_index){case 0:this.createQuestionAndAnswers('1、"哈罗单车HelloBike"的广告是否在本局游戏中出现',GameData.questionList.answer,-1);break;default:this.question_index=0,this.createBackground(14474460,1),this.dispatchEventWith(moon.MoonEvent.START),Tween.get(this).to({alpha:0},300).call(this.removeFromParent,this)}else switch(this.question_index){case 0:this.createQuestionAndAnswers("1、"+GameData.questionList.question[this.question_index],GameData.questionList.answer,GameData.questionList.num[this.question_index]);break;case 1:this.createQuestionAndAnswers("2、"+GameData.questionList.question[this.question_index],GameData.questionList.answer,GameData.questionList.num[this.question_index]);break;case 2:this.createQuestionAndAnswers("3、"+GameData.questionList.question[this.question_index],GameData.questionList.answer,GameData.questionList.num[this.question_index]);break;case 3:this.createQuestionAndAnswers("4、"+GameData.questionList.question[this.question_index],GameData.questionList.answer,GameData.questionList.num[this.question_index]);break;case 4:this.createQuestionAndAnswers("5、"+GameData.questionList.question[this.question_index],GameData.questionList.answer,GameData.questionList.num[this.question_index]);break;case 5:this.createQuestionAndAnswers("6、"+GameData.questionList.question[this.question_index],GameData.questionList.answer,GameData.questionList.num[this.question_index]);break;case 6:var t=["A、1分-不干扰","B、2分-稍微干扰","C、3分-有些干扰","D、4分-干扰","E、5分-非常干扰"],e="7、这种广告形式是否干扰到您的游戏操作：";this.createQuestionAndAnswers(e,t);break;case 7:var i=["A、1分-非常不愿意","B、2分-不愿意","C、3分-没有倾向","D、4分-愿意","E、5分-非常愿意"],n="8、您是否愿意继续玩有这种广告形式的该游戏：";this.createQuestionAndAnswers(n,i);break;default:if(this.question_index=0,GameData.gameIndex>GameData.GAMESNUMBER){this.removeChildren();var o=new TransferScreen("第 1/3 部分 - 基础问题","基础问题","panelQues");GameData.uploadMessage.push([]),this.addChild(o)}else this.dispatchEventWith(moon.MoonEvent.START),Tween.get(this).to({alpha:0},300).call(this.removeFromParent,this)}},e.prototype.createQuestionAndAnswers=function(t,e,i){void 0===i&&(i=100);var n=new Questionnaire;n.addEventListener(Questionnaire.ACTION,this.onAction,this),n.setQuestionAnswers(t,e,i),this.questionLayer.y=this.stageHeight/5,this.questionLayer.addChild(n),this.couldGoon=!1},e.prototype.onAction=function(){this.couldGoon=!0,console.log("变成true")},e.prototype.beginButtonTap=function(){if(this.couldGoon)this.question_index++,this.updateQuestion();else{console.log("请做出选择");var t=new egret.TextField;t.textAlign=egret.HorizontalAlign.CENTER,t.text='请先"选择答案"，再点击"下一步"',t.textColor=16711680,t.width=this.stageWidth,t.y=this.stageHeight-400,this.addChild(t);var e=this;egret.Tween.get(t).to({alpha:.4},1e3).call(function(){e.removeChild(t)})}},e}(moon.BasicGameStart);__reflect(Questionaire.prototype,"Questionaire");var Questionnaire=function(t){function e(){var e=t.call(this)||this;return e.stageW=0,e.stageH=0,e.init(),e.adverName=["q_alipay_jpg","q_geli_jpg","q_iphone_x_jpg","q_KFC_png","q_meituan_jpg","q_nike_png","q_ofo_jpg","q_pinduoduo_jpg","q_Starbucks_jpg","q_tebu_jpg","q_vivo_jpg","q_weiqian_jpg"],e}return __extends(e,t),e.prototype.getChoice=function(){return this.haschoice?this.choice:null},e.prototype.getIfChoice=function(){return this.haschoice},e.prototype.setQuestionAnswers=function(t,e,i){void 0===i&&(i=100),this.question=t,this.answers=e,this.creatQuestion(i)},e.prototype.init=function(){this.stageH=egret.MainContext.instance.stage.stageHeight,this.stageW=egret.MainContext.instance.stage.stageWidth,this.haschoice=!1},e.prototype.creatQuestion=function(t){var e=new egret.TextField;if(e.text=this.question,this.addChild(e),e.width=this.stageW-100,e.textColor=0,e.size=30,e.bold=!0,e.x=50,e.y=0,11>=t){var i=new egret.Bitmap;0>t?i.texture=RES.getRes("hellobike_jpg"):i.texture=RES.getRes(this.adverName[t]),i.width=200,i.height=200,i.x=(this.stageW-i.width)/2,i.y=e.y+e.height+20,this.addChild(i)}for(var n=0,o=0,a=this.answers;o<a.length;o++){var r=a[o],s=new egret.TextField;s.text=r,this.addChild(s),s.width=this.stageW-220,s.height=40,s.size=30,s.x=e.x+60,s.verticalAlign=egret.VerticalAlign.MIDDLE,n++,s.y=11>=t?i.y+i.height-10+n*(s.height+40):e.y+e.height-10+n*(s.height+40),s.textColor=0,s.background=!0,s.backgroundColor=13882323,s.touchEnabled=!0,s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.chooseAnswer,this)}},e.prototype.chooseAnswer=function(t){this.choice=t.target.text,this.haschoice?(this.currentView.textColor=0,this.currentView.backgroundColor=13882323,GameData.uploadMessage[GameData.uploadMessage.length-1][GameData.uploadMessage[GameData.uploadMessage.length-1].length-1]=this.answers.indexOf(this.choice)):GameData.uploadMessage[GameData.uploadMessage.length-1].push(this.answers.indexOf(this.choice)),this.currentView=t.target,this.haschoice=!0,this.dispatchEventWith(e.ACTION),this.currentView.textColor=2263842,this.currentView.backgroundColor=12433259,console.log("push 选择结果",this.answers.indexOf(this.choice))},e.ACTION="action",e}(egret.Sprite);__reflect(Questionnaire.prototype,"Questionnaire");var QuesScreen=function(t){function e(){var e=t.call(this)||this;return e.stageW=0,e.stageH=0,e.progress=0,e.hasChoice1=!1,e.hasChoice2=!1,e.couldGoOn=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.stageH=egret.MainContext.instance.stage.stageHeight,this.stageW=egret.MainContext.instance.stage.stageWidth,this.createBackGroundImage(),this.questionLayer||(this.questionLayer=new egret.Sprite),this.addChild(this.questionLayer),this.questionLayer.width=this.stageW,this.questionLayer.x=0,this.questionLayer.y=this.stageH/4,this.progress=1,this.updateQuestion(),this.createButtonImage()},e.prototype.layTxBg=function(t){var e=new egret.Shape;e.graphics.beginFill(16777215),e.graphics.drawRect(t.x,t.y,t.width,t.height),e.graphics.endFill(),this.questionLayer.addChild(e)},e.prototype.createInputName=function(t){this.questionLayer.width=this.stageW,this.questionLayer.x=0,this.questionLayer.y=this.stageH/3;var e=new egret.TextField;e.text=t,e.width=this.stageW-20,e.textColor=0,e.size=35,e.bold=!0,e.x=50,e.y=0,this.questionLayer.addChild(e);var i=new egret.Sprite;i.width=100,i.height=this.stageH;for(var n=function(t){var e=new egret.TextField;e.text=t.toString(),e.width=i.width,e.textColor=0,e.size=25,e.y=30*(t-18),e.x=0,e.touchEnabled=!0,e.textAlign=egret.HorizontalAlign.CENTER;var n=o;e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){n.hasChoice1&&(n.currentView1.textColor=0),n.currentView1=t.target,n.choice1=t.target.text,n.hasChoice1=!0,n.currentView1.textColor=2263842,console.log("选择了答案",n.choice1)},i),i.addChild(e)},o=this,a=18;70>a;a++)n(a);var r=new egret.ScrollView;r.setContent(i),r.width=100,r.height=300,r.x=this.stageW/2,r.y=e.y+r.height/2+10,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,this.addChild(r);var s=new egret.Shape;s.graphics.lineStyle(1,1114828),s.graphics.drawRect(0,0,100,300),s.graphics.endFill(),s.x=r.x,s.y=r.y,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,this.questionLayer.addChild(s),this.questionLayer.addChild(r),this.addChild(this.questionLayer)},e.prototype.createInputAge=function(t){this.questionLayer.width=this.stageW,this.questionLayer.x=0;var e=new egret.TextField;e.text=t,e.width=this.stageW-20,e.textColor=0,e.size=35,e.bold=!0,e.x=50,e.y=0,this.questionLayer.addChild(e);var i=new egret.Sprite;i.width=100,i.height=this.stageH;for(var n=function(t){var e=new egret.TextField;e.text=t.toString(),e.width=i.width,e.textColor=0,e.size=25,e.y=30*(t-18),e.x=0,e.touchEnabled=!0,e.textAlign=egret.HorizontalAlign.CENTER;var n=o;e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){n.choice1=t.target.text,n.couldGoOn=!0,n.hasChoice1?(n.currentView1.textColor=0,GameData.uploadMessage[GameData.uploadMessage.length-1][GameData.uploadMessage[GameData.uploadMessage.length-1].length-1]=parseInt(n.choice1)):GameData.uploadMessage[GameData.uploadMessage.length-1].push(parseInt(n.choice1)),n.currentView1=t.target,n.hasChoice1=!0,n.currentView1.textColor=2263842,console.log("选择了答案",n.choice1)},i),i.addChild(e)},o=this,a=18;70>a;a++)n(a);var r=new egret.ScrollView;r.setContent(i),r.width=100,r.height=300,r.x=this.stageW/2,r.y=e.y+r.height/2+10,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,this.addChild(r);var s=new egret.Shape;s.graphics.lineStyle(1,1114828),s.graphics.drawRect(0,0,100,300),s.graphics.endFill(),s.x=r.x,s.y=r.y,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,this.questionLayer.addChild(s),this.questionLayer.addChild(r)},e.prototype.createGird=function(t,e,i,n){for(var o=new egret.Shape,a=0;i>a;a++)for(var r=0;n>r;r++)(r+i*a)%2===0?(o.graphics.beginFill(16368139),o.graphics.drawRect(r*t,a*e,t,e),o.graphics.endFill()):(o.graphics.beginFill(2793471),o.graphics.drawRect(r*t,a*e,t,e),o.graphics.endFill());return o},e.prototype.createBackGroundImage=function(){var t=new egret.Shape;t.graphics.clear(),t.graphics.beginFill(14474460),t.graphics.drawRect(0,0,this.stageW,this.stageH),t.graphics.endFill(),this.addChild(t)},e.prototype.createQuestionAndAnswers=function(t,e){var i=new Questionnaire;i.addEventListener(Questionnaire.ACTION,this.onAction,this),i.setQuestionAnswers(t,e),this.questionLayer.addChild(i),this.couldGoOn=!1},e.prototype.onAction=function(){this.couldGoOn=!0},e.prototype.createButtonImage=function(){var t=new egret.Bitmap;t.texture=RES.getRes("button_png"),t.width=t.width/2,t.height=t.height/2,t.x=this.stageW/2-t.width/2,t.y=this.stageH-t.height-200;var e=new egret.TextField;e.text="已完成，下一题",e.width=t.width,e.x=t.x,e.size=25,e.y=t.y+(t.height/2-e.height/2)-5,e.textAlign=egret.HorizontalAlign.CENTER,e.textColor=0,this.addChild(t),this.addChild(e),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.beginButtonTap,this)},e.prototype.beginButtonTap=function(){if(this.couldGoOn)this.progress=this.progress+1,this.updateQuestion();else{var t=new egret.TextField;t.textAlign=egret.HorizontalAlign.CENTER,t.text='请先"选择答案"，再点击"下一步"',t.textColor=16711680,t.width=this.stageW,t.y=this.stageH-400,this.addChild(t);var e=this;egret.Tween.get(t).to({alpha:.4},1e3).call(function(){e.removeChild(t)})}},e.prototype.createWelcome=function(){var t=new egret.TextField;t.text="致谢",t.width=this.stageW-20,t.textColor=0,t.bold=!0,t.x=10,t.size=40,t.textAlign=egret.HorizontalAlign.CENTER,t.y=40;var e=new egret.TextField;e.text="感谢您参与IGA实验",e.width=this.stageW-20,e.textColor=0,e.size=20,e.bold=!1,e.x=10,e.textAlign=egret.HorizontalAlign.CENTER,e.y=t.y+60;var i=new egret.TextField;i.text="请您接受实验人员的采访",i.width=this.stageW,i.textColor=0,i.size=40,i.bold=!0,i.textAlign=egret.HorizontalAlign.CENTER,i.x=0,i.y=this.stageH/2.5,this.addChild(t),this.addChild(e),this.addChild(i)},e.prototype.updateQuestion=function(){switch(this.questionLayer.removeChildren(),this.progress){case 1:var t=["A、每天一个小时以上","B、每天一个小时以内","C、每周玩几次","D、偶尔玩","E、几乎不玩"],e="1、您玩微信小游戏的时长：";this.createQuestionAndAnswers(e,t);break;case 2:this.couldGoOn=!1,this.createInputAge("2、您的年龄:");break;case 3:var i=["A、男","B、女"],n="3、您的性别：";this.createQuestionAndAnswers(n,i);break;case 4:var o=["A、博士","B、研究生","C、本科","D、高中及以下","E、其他"],a="4、您的学业水平：";this.createQuestionAndAnswers(a,o)}if(5==this.progress){this.removeChildren(),this.createBackGroundImage();var r=new egret.TextField;r.width=this.stageW,r.textColor=16711680,r.size=35,r.textAlign=egret.HorizontalAlign.CENTER,r.bold=!0,r.y=this.stageH/2-30,this.addChild(r),r.text="请把手机交给实验人员！",this.createNextButtonImage(),this.createWelcome()}},e.prototype.createNextButtonImage=function(){this.button_img=new egret.Bitmap,this.button_img.texture=RES.getRes("button_png"),this.button_img.width=this.button_img.width/2,this.button_img.height=this.button_img.height/2,this.button_img.x=this.stageW/2-this.button_img.width/2,this.button_img.y=this.stageH-this.button_img.height-120,this.button_txt=new egret.TextField,this.button_txt.text="发送数据",this.button_txt.width=this.button_img.width,this.button_txt.x=this.button_img.x,this.button_txt.size=25,this.button_txt.y=this.button_img.y+(this.button_img.height/2-this.button_txt.height/2)-5,this.button_txt.textAlign=egret.HorizontalAlign.CENTER,this.button_txt.textColor=0,this.addChild(this.button_img),this.addChild(this.button_txt),this.button_img.touchEnabled=!0,this.button_img.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendToserver,this)},e.prototype.sendToserver=function(){this.createBackGroundImage();var t=new DataProcess;this.addChild(t);for(var e=GameData.uploadMessage,i="",n=["p1","g1","g2","g3","g4","g5","g6","q1","q2","q3"],o=0,a=0,r=e;a<r.length;a++){for(var s=r[a],h="",l=0,d=s;l<d.length;l++){var c=d[l];h=h+c.toString()+" "}i=""==i?n[o]+"="+h:i+"&"+n[o]+"="+h,o+=1}this.removeChild(this.button_img),this.removeChild(this.button_txt);var u=new egret.HttpRequest;u.withCredentials=!0,u.responseType=egret.HttpResponseType.TEXT,u.open("//icontinua.com/ftf/minigame/sendData2",egret.HttpMethod.POST),u.setRequestHeader("content-type","application/x-www-form-urlencoded"),u.send(i),u.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),u.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),u.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},e.prototype.sendToRank=function(){var t="name="+GameData.uploadUser.names+"&fullscore="+GameData.uploadUser.fullscore+"&maxscore="+GameData.uploadUser.maxscore,e=new egret.HttpRequest;e.withCredentials=!0,e.responseType=egret.HttpResponseType.TEXT,e.open("//icontinua.com/ftf/minigame/saveRank2",egret.HttpMethod.POST),e.setRequestHeader("content-type","application/x-www-form-urlencoded"),e.send(t),e.addEventListener(egret.Event.COMPLETE,this.onGetComplete2,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),e.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},e.prototype.onGetComplete=function(t){var e=t.currentTarget;console.log("get data : ",e.response),this.responseLabel||(this.responseLabel=new egret.TextField),this.responseLabel.size=18,this.responseLabel.text="GET response: \n"+e.response.substring(0,50)+"...",this.addChild(this.responseLabel),this.responseLabel.x=50,this.responseLabel.y=70,this.sendToRank()},e.prototype.onGetComplete2=function(t){var e=t.currentTarget;console.log("get data : ",e.response),this.responseLabel||(this.responseLabel=new egret.TextField),this.responseLabel.size=18,this.responseLabel.text="GET response: \n"+e.response+"...",this.addChild(this.responseLabel),this.responseLabel.x=50,this.responseLabel.y=170},e.prototype.onGetIOError=function(t){console.log(t),this.responseLabel||(this.responseLabel=new egret.TextField),this.responseLabel.size=18,this.responseLabel.text=t.data.toString()+"...",this.addChild(this.responseLabel),this.responseLabel.x=50,this.responseLabel.y=70},e.prototype.onGetProgress=function(t){console.log("get progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%"),this.responseLabel||(this.responseLabel=new egret.TextField),this.responseLabel.size=18,this.responseLabel.text=Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%",this.addChild(this.responseLabel),this.responseLabel.x=50,this.responseLabel.y=70},e}(egret.Sprite);__reflect(QuesScreen.prototype,"QuesScreen");var Rank=function(t){function e(){var e=t.call(this)||this;return e.stageH=0,e.stageW=0,e.lastIndex=-1,e.stageH=egret.MainContext.instance.stage.stageHeight,e.stageW=egret.MainContext.instance.stage.stageWidth,e.lastIndex=-1,e}return __extends(e,t),e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.sortRankList=function(){function t(t,e){return function(i,n){var o=i[t],a=n[t],r=i[e],s=n[e];return o==a?-(r-s):-(o-a)}}var e=[];return e.push(GameData.uploadUser),e=e.concat(GameData.RankList),e=e.sort(t("fullscore","maxscore"))},e.prototype.createTextFiled=function(t,e,i,n,o,a,r,s){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=30),void 0===r&&(r=!0),void 0===s&&(s=16777215);var h=new egret.TextField;return h.text=t,h.width=e,h.height=i,h.verticalAlign=egret.VerticalAlign.MIDDLE,r&&(h.textAlign=egret.HorizontalAlign.CENTER),h.bold=!0,h.textColor=s,h.size=a,h.y=n,h.x=o,h},e.prototype.createTextFlow=function(t,e,i,n,o,a,r,s){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=30),void 0===r&&(r=!0),void 0===s&&(s=16777215);var h=new egret.TextField;return h.width=e,h.height=i,h.verticalAlign=egret.VerticalAlign.MIDDLE,r&&(h.textAlign=egret.HorizontalAlign.CENTER),h.textFlow=t,h.bold=!0,h.textColor=s,h.size=a,h.y=n,h.x=o,h},e.prototype.createRankList=function(t,e){for(var i=new egret.Sprite,n=1;n<=t.length;n++){var o=new egret.Shape;o.graphics.clear(),n==e?o.graphics.beginFill(13479829,1):n%2==0?o.graphics.beginFill(4213332,1):o.graphics.beginFill(3555402,1),o.graphics.drawRect(0,(n-1)*this.stageH/15,this.stageW-40,this.stageH/15),o.graphics.endFill();var a=this.createTextFiled(n.toString(),o.width/5,o.height,(n-1)*this.stageH/15);switch(n){case 1:a.textColor=14309639;break;case 2:a.textColor=16357981;break;case 3:a.textColor=16499357;break;default:a.textColor=13881807}if(n==e){var r=0;if(r=-1==this.lastIndex?t.length-e:this.lastIndex-e,this.lastIndex=e,r>0)var s=[{text:t[n-1].names},{text:" ↑"+r.toString(),style:{fontFamily:"微软雅黑",textColor:65280,bold:!0}}];else if(0>r)var s=[{text:t[n-1].names},{text:" ↓"+(-1*r).toString(),style:{fontFamily:"微软雅黑",textColor:16711680,bold:!0}}];else var s=[{text:t[n-1].names},{text:" - ",style:{fontFamily:"微软雅黑",textColor:255,bold:!0}}];var h=this.createTextFlow(s,1.7*o.width/5,o.height,(n-1)*this.stageH/15,a.x+a.width,30,!1)}else var h=this.createTextFiled(t[n-1].names,1.7*o.width/5,o.height,(n-1)*this.stageH/15,a.x+a.width,30,!1);var l=this.createTextFiled(t[n-1].fullscore,1.15*o.width/5,o.height,(n-1)*this.stageH/15,h.x+h.width),d=this.createTextFiled(t[n-1].maxscore,1.15*o.width/5,o.height,(n-1)*this.stageH/15,l.x+l.width);i.addChild(o),i.addChild(a),i.addChild(h),i.addChild(l),i.addChild(d)}return i},e.prototype.RankList=function(){this.removeChildren();var t=this.sortRankList(),e=t.indexOf(GameData.uploadUser)+1;console.log(t);var i=this.createRankList(t,e),n=new egret.ScrollView;n.setContent(i),n.width=this.stageW-40,n.height=this.stageH/2.7,n.x=this.stageW/2,n.y=this.stageH/2+60,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.setScrollTop(this.stageH/15*(e-3)),n.verticalScrollPolicy="on",n.horizontalScrollPolicy="off";var o=n.y-n.height/2-this.stageH/15;this.createSigleLine(o,"排名","昵称","总分","单局最高分",25);n.y+n.height/2+25;this.addChild(n);var a=o-80;this.Ranktitle(a)},e.prototype.createSigleLine=function(t,e,i,n,o,a){var r=new egret.Shape;r.graphics.clear(),r.graphics.beginFill(4213332,1),r.graphics.drawRect(20,t,this.stageW-40,this.stageH/15),r.graphics.endFill();var s=this.createTextFiled(e,r.width/5,r.height,t,r.x+10,a);switch(e){case"1":s.textColor=14309639;break;case"2":s.textColor=16357981;break;case"3":s.textColor=16499357;break;default:s.textColor=13881807}var h=this.createTextFiled(i,1.7*r.width/5,r.height,t,s.x+s.width,a,!1),l=this.createTextFiled(n,1.15*r.width/5,r.height,t,h.x+h.width,a),d=this.createTextFiled(o,1.15*r.width/5,r.height,t,l.x+l.width,a);this.addChild(r),this.addChild(s),this.addChild(h),this.addChild(l),this.addChild(d)},e.prototype.Ranktitle=function(t){var e=new egret.TextField;e.fontFamily="微软雅黑",e.width=400,e.text="排行榜",e.x=this.stageW/2-e.width/2,e.y=t,e.textColor=16777215,e.size=40,e.bold=!0,e.textAlign=egret.HorizontalAlign.CENTER,this.addChild(e)},e}(egret.Sprite);__reflect(Rank.prototype,"Rank");var GameRank=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateScore=function(){platform.getRank(this.update,this)},e.prototype.update=function(t){console.log("代码:"+t.code+",消息:"+t.message+",数据:"+t.data);var e=GamePanel.rank;if(1e4==t.code){console.log("获取成功");for(var i=t.data,n=i.length,o=-1,a=0;n>a;a++){var r=i[a].score;if(console.log(a,r,e.max),a<e.max){var s=e.items[a];s.txtScore.text=r,console.log("item",s.txtScore.text,r)}if(n-1>a){var h=Number(i[a+1].score);r=Number(r),console.log(GameData.score,h,r),GameData.score==r?o=a+1:GameData.score>h&&GameData.score<=r?o=a+2:GameData.score>=i[0].score?o=1:GameData.score<=i[n-1].score&&(o=n)}}e.txtRank&&(o>0?e.txtRank.text="你本次得"+GameData.score+"分，排在第"+o+"名。":e.txtRank.text="未上榜")}else console.log("获取失败")},e}(moon.BasicGameRank);__reflect(GameRank.prototype,"GameRank");var DataProcess=function(t){function e(){var e=t.call(this)||this;return e.stageH=egret.MainContext.instance.stage.stageHeight,e.stageW=egret.MainContext.instance.stage.stageWidth,e.createLine(),e}return __extends(e,t),e.prototype.createLine=function(){var t=GameData.uploadMessage.concat(),e=this.createRankList(t),i=new egret.ScrollView;i.setContent(e),i.width=this.stageW,i.height=this.stageH/2,i.x=this.stageW/2,i.y=this.stageH/2+60,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.verticalScrollPolicy="on",i.horizontalScrollPolicy="off",this.addChild(i)},e.prototype.createTextFiled=function(t,e,i,n,o,a,r,s){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=30),void 0===r&&(r=!0),void 0===s&&(s=16777215);var h=new egret.TextField;return h.text=t,h.width=e,h.height=i,h.verticalAlign=egret.VerticalAlign.MIDDLE,r&&(h.textAlign=egret.HorizontalAlign.CENTER),h.bold=!0,h.textColor=s,h.size=a,h.y=n,h.x=o,h},e.prototype.resultSingleJudge=function(t,e){for(var i=[0,0,0,0,0,0],n=0;n<e.length;n++)t.indexOf(e[n])>=0&&(i[n]=1);return i},e.prototype.resultJudgeRightFalse=function(t){var e=[0,0],i=t.slice(1,4);(2==t[0]||4==t[0])&&(i=t.slice(1,1+t[11]));for(var n=t.slice(4,10),o=this.resultSingleJudge(i,n),a=t.slice(15,21),r=0;r<o.length;r++)o[r]==a[r]&&(1==o[r]?e[0]++:e[1]++);return""+e[0]+" / "+e[1]},e.prototype.resultRightFalse=function(t){var e=t.slice(1,4);(2==t[0]||4==t[0])&&(e=t.slice(1,1+t[11]));var i=t.slice(4,10),n=this.resultSingleJudge(e,i),o=t.slice(15,21),a=n.join(""),r=o.join("");return a+" / "+r},e.prototype.createRankList=function(t){for(var e=new egret.Sprite,i=1;i<t.length-1;i++){var n=new egret.Shape;n.graphics.clear(),n.graphics.beginFill(3555402,1),n.graphics.drawRect(0,(i-1)*this.stageH/15,this.stageW-40,this.stageH/15),n.graphics.endFill();var o=this.createTextFiled(t[i][0]+"",n.width/7,n.height,(i-1)*this.stageH/15);o.textColor=14309639;var a=this.createTextFiled(t[i][21]+"",1*n.width/7,n.height,(i-1)*this.stageH/15,o.x+o.width,30,!1),r=this.createTextFiled(t[i][22]+"",1*n.width/7,n.height,(i-1)*this.stageH/15,a.x+a.width),s=this.createTextFiled(this.resultJudgeRightFalse(t[i]),1*n.width/7,n.height,(i-1)*this.stageH/15,r.x+r.width),h=this.createTextFiled(this.resultRightFalse(t[i]),3*n.width/7,n.height,(i-1)*this.stageH/15,s.x+s.width);e.addChild(n),e.addChild(o),e.addChild(a),e.addChild(r),e.addChild(s),e.addChild(h)}return e},e}(egret.Sprite);__reflect(DataProcess.prototype,"DataProcess");var GameSet=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(moon.BasicGameSet);__reflect(GameSet.prototype,"GameSet");